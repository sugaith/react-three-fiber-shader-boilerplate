!function(o){o.imageMapProShapeDefaults={id:"spot-0",title:"",type:"spot",x:-1,y:-1,width:44,height:44,x_image_background:-1,y_image_background:-1,width_image_background:44,height_image_background:44,connected_to:"",use_connected_shape_tooltip:0,layerID:0,static:0,text:{text:"Text",font_family:"sans-serif",font_size:16,font_weight:400,text_color:"#000000",text_opacity:1},actions:{click:"no-action",link:"#",open_link_in_new_window:1,script:""},default_style:{opacity:1,border_radius:50,background_type:"color",background_image_url:"",background_image_opacity:1,background_image_scale:1,background_image_offset_x:0,background_image_offset_y:0,background_color:"#000000",background_opacity:.4,border_width:0,border_style:"solid",border_color:"#ffffff",border_opacity:1,stroke_color:"#ffffff",stroke_opacity:.75,stroke_width:0,stroke_dasharray:"0",stroke_linecap:"round",use_icon:1,icon_type:"library",icon_svg_path:"M409.81,160.113C409.79,71.684,338.136,0,249.725,0C161.276,0,89.583,71.684,89.583,160.113     c0,76.325,119.274,280.238,151.955,334.638c1.72,2.882,4.826,4.641,8.178,4.641c3.351,0,6.468-1.759,8.168-4.631     C290.545,440.361,409.81,236.438,409.81,160.113z M249.716,283.999c-68.303,0-123.915-55.573-123.915-123.895     c0-68.313,55.592-123.895,123.915-123.895s123.876,55.582,123.876,123.895S318.029,283.999,249.716,283.999z",icon_svg_viewbox:"0 0 499.392 499.392",icon_fontawesome_id:"map-marker",icon_fill:"#000000",icon_url:"",icon_is_pin:1,icon_shadow:0},mouseover_style:{opacity:1,border_radius:50,background_image_url:"",background_image_opacity:1,background_image_scale:1,background_image_offset_x:0,background_image_offset_y:0,background_color:"#ffffff",background_opacity:.4,border_width:0,border_style:"solid",border_color:"#ffffff",border_opacity:1,stroke_color:"#ffffff",stroke_opacity:.75,stroke_width:0,stroke_dasharray:"0",stroke_linecap:"round",icon_fill:"#000000"},tooltip:{enable_tooltip:1},tooltip_style:{buffer:40,border_radius:10,padding:15,background_color:"#222222",background_opacity:1,position:"top",width:225,auto_width:1,offset_x:0,offset_y:0},tooltip_content:{squares_settings:{containers:[{id:"sq-container-403761",settings:{elements:[{settings:{name:"Heading",iconClass:"fa fa-header"},options:{heading:{text:"My Shape"}}}]}}]}},points:[],vs:[],svgPathCommands:[],d:"",dEditor:""},o.imageMapProEditorDefaults={id:0,editor:{previewMode:0,selected_shape:-1,transform_tooltip_mode:0,tool:"spot",zoom:1,currentLayer:0,state:{dragging:!1},shapeCounter:{spots:0,rects:0,ovals:0,polys:0,texts:0,paths:0}},runtime:{is_fullscreen:0,layerID:0,menu_search_string:"",menu_scroll:0},general:{name:"",shortcode:"",width:800,height:450,naturalWidth:800,naturalHeight:450,responsive:1,preserve_quality:1,center_image_map:0},image:{url:""},fullscreen:{enable_fullscreen_mode:0,start_in_fullscreen_mode:0,fullscreen_background:"#000000",fullscreen_button_position:1,fullscreen_button_type:"icon_and_text",fullscreen_button_color:"#ffffff",fullscreen_button_text_color:"#222222"},shapes:{pageload_animation:"none",glowing_shapes:0,glowing_shapes_color:"#ffffff",glow_opacity:.5,stop_glowing_on_mouseover:1},tooltips:{enable_tooltips:1,show_tooltips:"mouseover",show_title_on_mouseover:0,sticky_tooltips:0,constrain_tooltips:1,tooltip_animation:"none",fullscreen_tooltips:"mobile-only"},zooming:{enable_zooming:0,max_zoom:16,limit_max_zoom_to_image_size:0,enable_zoom_buttons:1,enable_navigator:1,zoom_button_text_color:"#000000",zoom_button_background_color:"#ffffff",hold_ctrl_to_zoom:1,focus_shape_on_click:1},layers:{enable_layers:0,layers_list:[]},shapes_menu:{enable_shapes_menu:0,detached_menu:0,menu_position:"left",enable_search:1,group_by_floor:0,hide_children_of_connected_shapes:1},custom_code:{custom_css:"",custom_js:""},spots:[]}}(jQuery,(window,document));
!function(r){var a=new Array;function t(t){this.settings=t,this.containers=[],this.init()}function e(t){this.settings=t,this.elements=[],this.init()}r.squaresRendererRegisterElement=function(t){a[t.name]=t},r.squaresRendererRenderObject=function(e){if("object"!=typeof e)try{e=JSON.parse(e)}catch(t){return console.log(t),console.log("Squares renderer failed to parse JSON: "),console.log(e),""}return new t(e).render()},t.prototype.init=function(){for(var t=0;t<this.settings.containers.length;t++)this.containers[t]=new e(this.settings.containers[t])},t.prototype.render=function(){for(var t="",e=0;e<this.containers.length;e++)t+=this.containers[e].render();return t},e.prototype.init=function(){if(this.settings.settings)for(var t=0;t<this.settings.settings.elements.length;t++)this.elements[t]=new i(this.settings.settings.elements[t])},e.prototype.render=function(){var t="";if(t+='<div class="squares-container">',this.settings.settings)for(var e=0;e<this.settings.settings.elements.length;e++)t+=this.elements[e].render();return t=t+'\t<div class="squares-clear"></div>'+"</div>"};var s={layout:{box_model:{margin:{top:0,bottom:0,left:0,right:0},padding:{top:10,bottom:10,left:10,right:10}},use_grid:1,column_span:{xs:{use:0,class:"sq-col-xs-12",visible:0},sm:{use:0,class:"sq-col-sm-12",visible:0},md:{use:0,class:"sq-col-md-12",visible:1},lg:{use:1,class:"sq-col-lg-12",visible:1}},width:"100",auto_width:1,height:"100",auto_height:1},style:{background_color:"#ffffff",background_opacity:"0",opacity:"1",box_shadow:"none",border_width:"0",border_style:"none",border_color:"#000000",border_opacity:"1",border_radius:"0"},font:{font_family:"sans-serif",font_size:"14",font_weight:"normal",font_style:"normal",line_height:"22",text_color:"#ffffff",text_align:"left",text_decoration:"none",text_transform:"none",text_shadow:""},general:{id:"",classes:"",css:""}};function i(t){this.settings=t.settings,this.defaults=r.extend(!0,{},s),this.elementSpecificDefaults={},this.options=void 0,this.init(t)}function o(t){t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:0,g:0,b:0}}i.prototype.init=function(t){if(this.settings){var e,s=r.extend(!0,{},a[this.settings.name].controls);for(e in s){var i,o=s[e];for(i in this.elementSpecificDefaults[e]={},o){var n=o[i];this.elementSpecificDefaults[e][i]=n.default}}this.defaults=r.extend(!0,{},this.defaults,this.elementSpecificDefaults),this.options=r.extend(!0,{},this.defaults,t.options)}},i.prototype.render=function(){var t;if(this.settings)return t="",(t+='<div class="squares-element '+this.generateLayoutClass(this.options.layout)+'" style="'+this.generateCSS(this.options)+'">')+a[this.settings.name].render(this.options)+"</div>"},i.prototype.generateLayoutClass=function(){var t,e;if(this.settings)return e=this.options.layout,1==parseInt(e.use_grid,10)?(t="",e=e.column_span,1==parseInt(e.xs.use,10)&&(t+=e.xs.class+" ",0==parseInt(e.xs.visible,10)&&(t+="sq-hidden-sm ")),1==parseInt(e.sm.use,10)&&(t+=e.sm.class+" ",0==parseInt(e.sm.visible,10)&&(t+="sq-hidden-md ")),1==parseInt(e.md.use,10)&&(t+=e.md.class+" ",0==parseInt(e.md.visible,10)&&(t+="sq-hidden-lg ")),1==parseInt(e.lg.use,10)&&(t+=e.lg.class+" ",0==parseInt(e.lg.visible,10)&&(t+="sq-hidden-xl ")),t):""},i.prototype.generateCSS=function(){var t,e,s;if(this.settings)return s="",s=(s=(s=(s=(s=(s=(s=(s+="margin-top: "+(t=this.options.layout).box_model.margin.top+"px; ")+"margin-bottom: "+t.box_model.margin.bottom+"px; ")+"margin-left: "+t.box_model.margin.left+"px; ")+"margin-right: "+t.box_model.margin.right+"px; ")+"padding-top: "+t.box_model.padding.top+"px; ")+"padding-bottom: "+t.box_model.padding.bottom+"px; ")+"padding-left: "+t.box_model.padding.left+"px; ")+"padding-right: "+t.box_model.padding.right+"px; ",1!=parseInt(t.use_grid,10)&&(1==parseInt(t.auto_width,10)?s+="width: auto; ":""===t.width||isNaN(t.width)||(s+="width: "+t.width+"px; "),1==parseInt(t.auto_height,10)?s+="height: auto; ":""===t.height||isNaN(t.height)||(s+="height: "+t.height+"px; ")),t=this.options.font,this.options.fontStyles="",t&&(s+="font-family: "+t.font_family+"; ",this.options.fontStyles+="font-family: "+t.font_family+"; ",s+="font-size: "+t.font_size+"px; ",this.options.fontStyles+="font-size: "+t.font_size+"px; ",s+="font-weight: "+t.font_weight+"; ",this.options.fontStyles+="font-weight: "+t.font_weight+"; ",s+="font-style: "+t.font_style+"; ",this.options.fontStyles+="font-style: "+t.font_style+"; ",s+="line-height: "+t.line_height+"px; ",this.options.fontStyles+="line-height: "+t.line_height+"px; ",s+="color: "+t.text_color+"; ",this.options.fontStyles+="color: "+t.text_color+"; ",s+="text-align: "+t.text_align+"; ",this.options.fontStyles+="text-align: "+t.text_align+"; ",s+="text-decoration: "+t.text_decoration+"; ",this.options.fontStyles+="text-decoration: "+t.text_decoration+"; ",s+="text-transform: "+t.text_transform+"; ",this.options.fontStyles+="text-transform: "+t.text_transform+"; ",s+="text-shadow: "+t.text_shadow+"; ",this.options.fontStyles+="text-shadow: "+t.text_shadow+"; "),(t=this.options.style)&&(s=(s=(s=(s=(s+="background-color: rgba("+(e=o(t.background_color)).r+", "+e.g+", "+e.b+", "+t.background_opacity+"); ")+"opacity: "+t.opacity+"; ")+"box-shadow: "+t.box_shadow+"; ")+"border-width: "+t.border_width+"px; ")+"border-style: "+t.border_style+"; ",s=(s+="border-color: rgba("+(e=o(t.border_color)).r+", "+e.g+", "+e.b+", "+t.border_opacity+"); ")+"border-radius: "+t.border_radius+"px; "),s}}(jQuery,(window,document));
!function(o,s){var e={name:"Paragraph",iconClass:"fa fa-paragraph",controls:{text:{text:{name:"Text",type:"textarea",default:"Lorem ipsum dolor sit amet, consectetuer adipiscing elit."}}},controlGroupIcons:{text:"fa fa-ellipsis-h"},content:function(){var e=this.controls.text.text.getVal();return e=(e=e.replace(/\\(.)/gm,"$1")).replace(/\n/gm,"<br>"),'<p id="'+this.controls.general.id.getVal()+'" style="'+this.controls.general.css.getVal()+this.fontStyles+' margin: 0; padding: 0;" class="'+this.controls.general.classes.getVal()+'">'+e+"</p>"},render:function(e){var t=e.text.text;return t=(t=t.replace(/\\(.)/gm,"$1")).replace(/\n/gm,"<br>"),'<p id="'+e.general.id+'" style="'+e.general.css+e.fontStyles+' margin: 0; padding: 0;" class="'+e.general.classes+'">'+t+"</p>"}},e=(o.squaresRegisterElement&&o.squaresRegisterElement(e),o.squaresRendererRegisterElement(e),{name:"Heading",iconClass:"fa fa-header",controls:{heading:{text:{name:"Text",type:"text",default:"Lorem Ipsum"},heading:{name:"Heading",type:"select",options:["h1","h2","h3"],default:"h3"}}},controlGroupIcons:{heading:"fa fa-header"},content:function(){return"<"+this.controls.heading.heading.getVal()+' id="'+this.controls.general.id.getVal()+'" style="'+this.controls.general.css.getVal()+this.fontStyles+' margin: 0; padding: 0;" class="'+this.controls.general.classes.getVal()+'">'+this.controls.heading.text.getVal()+"</"+this.controls.heading.heading.getVal()+">"},render:function(e){return"<"+e.heading.heading+' id="'+e.general.id+'" style="'+e.general.css+e.fontStyles+' margin: 0; padding: 0;" class="'+e.general.classes+'">'+e.heading.text+"</"+e.heading.heading+">"}}),e=(o.squaresRegisterElement&&o.squaresRegisterElement(e),o.squaresRendererRegisterElement(e),{name:"Image",iconClass:"fa fa-camera",controls:{image:{url:{name:"Image URL",type:"text",default:"https://webcraftplugins.com/uploads/placeholder_image.png"},image_is_a_link:{name:"Image is a Link",type:"switch",default:0},link_to:{name:"Link to",type:"text",default:"#"}}},controlGroupIcons:{image:"fa fa-camera"},useFontControls:!1,content:function(){var e="",t=(1==parseInt(this.controls.image.image_is_a_link.getVal(),10)&&(e+='<a href="'+this.controls.image.link_to.getVal()+'">'),e+='<img src="'+this.controls.image.url.getVal()+'" id="'+this.controls.general.id.getVal()+'" style="'+this.controls.general.css.getVal()+'" class="'+this.controls.general.classes.getVal()+'">',1==parseInt(this.controls.image.image_is_a_link.getVal(),10)&&(e+="</a>"),new Image);function a(){}return t.src=this.controls.image.url.getVal(),t.complete||t.addEventListener("load",a),e},render:function(e){var t="",a=(1==parseInt(e.image.image_is_a_link,10)&&(t+='<a href="'+e.image.link_to+'">'),t+='<img src="'+e.image.url+'" id="'+e.general.id+'" style="'+e.general.css+'" class="'+e.general.classes+'">',1==parseInt(e.image.image_is_a_link,10)&&(t+="</a>"),new Image);function l(){o(s).trigger("squares_image_loaded")}return a.src=e.image.url,a.complete?l():a.addEventListener("load",l),t}}),e=(o.squaresRegisterElement&&o.squaresRegisterElement(e),o.squaresRendererRegisterElement(e),{name:"Video",iconClass:"fa fa-video-camera",controls:{video:{mp4_url:{name:"MP4 URL",type:"text",default:"http://webcraftplugins.com/uploads/example_video.mp4"},webm_url:{name:"WEBM URL",type:"text",default:"http://webcraftplugins.com/uploads/example_video.webm"},ogv_url:{name:"OGV URL",type:"text",default:"http://webcraftplugins.com/uploads/example_video.ogv"},video_is_a_link:{name:"Video is a Link",type:"switch",default:0},link_to:{name:"Link to",type:"text",default:"#"},autoplay:{name:"Autoplay",type:"switch",default:0},loop:{name:"Loop",type:"switch",default:0},controls:{name:"Controls",type:"switch",default:0}}},useFontControls:!1,controlGroupIcons:{video:"fa fa-video-camera"},content:function(){var e="",t=(1==parseInt(this.controls.video.video_is_a_link.getVal(),10)&&(e+='<a href="'+this.controls.video.link_to.getVal()+'">'),"");return 1==parseInt(this.controls.video.autoplay.getVal(),10)&&(t+=" autoplay "),1==parseInt(this.controls.video.loop.getVal(),10)&&(t+=" loop "),1==parseInt(this.controls.video.controls.getVal(),10)&&(t+=" controls "),e+="<video "+t+' id="'+this.controls.general.id.getVal()+'" style="'+this.controls.general.css.getVal()+'" class="'+this.controls.general.classes.getVal()+'"><source src="'+this.controls.video.mp4_url.getVal()+'" type="video/mp4"><source src="'+this.controls.video.webm_url.getVal()+'" type="video/webm"><source src="'+this.controls.video.ogv_url.getVal()+'" type="video/ogv"></video>',1==parseInt(this.controls.video.video_is_a_link.getVal(),10)&&(e+="</a>"),e},render:function(e){var t="",a=(1==parseInt(e.video.video_is_a_link,10)&&(t+='<a href="'+e.video.link_to+'">'),"");return 1==parseInt(e.video.autoplay,10)&&(a+=" autoplay "),1==parseInt(e.video.loop,10)&&(a+=" loop "),1==parseInt(e.video.controls,10)&&(a+=" controls "),t+="<video "+a+' id="'+e.general.id+'" style="'+e.general.css+'" class="'+e.general.classes+'"><source src="'+e.video.mp4_url+'" type="video/mp4"><source src="'+e.video.webm_url+'" type="video/webm"><source src="'+e.video.ogv_url+'" type="video/ogv"></video>',1==parseInt(e.video.video_is_a_link,10)&&(t+="</a>"),t}}),e=(o.squaresRegisterElement&&o.squaresRegisterElement(e),o.squaresRendererRegisterElement(e),{name:"YouTube",iconClass:"fa fa-youtube",useStyleControls:!1,useFontControls:!1,controls:{youtube:{embed_code:{name:"Embed Code",type:"textarea",default:'<iframe width="560" height="315" src="https://www.youtube.com/embed/6NC_ODHu5jg" frameborder="0" allowfullscreen></iframe>'},allow_fullscreen:{name:"Allow Fullscreen (Doesn't work in Editor)",type:"switch",default:1},iframe_width:{name:"iframe Width",type:"int",default:320},iframe_auto_width:{name:"iframe Auto Width",type:"switch",default:1},iframe_height:{name:"iframe Height",type:"int",default:320}}},controlGroupIcons:{youtube:"fa fa-youtube"},content:function(){var e=this.controls.youtube.embed_code.getVal(),t="";return t+='<div id="'+this.controls.general.id.getVal()+'" style="'+this.controls.general.css.getVal()+'" class="'+this.controls.general.classes.getVal()+'">',e=e.replace("allowfullscreen",""),1==parseInt(this.controls.youtube.allow_fullscreen.getVal(),10)&&-1==e.indexOf("allowfullscreen")&&(e=e.replace("></iframe>"," allowfullscreen></iframe>")),t+(e=(e=1==parseInt(this.controls.youtube.iframe_auto_width.getVal(),10)?e.replace(/width="\d+"/g,'width="100%"'):e.replace(/width="\d+"/g,'width="'+this.controls.youtube.iframe_width.getVal()+'px"')).replace(/height="\d+"/g,'height="'+this.controls.youtube.iframe_height.getVal()+'px"'))+"</div>"},render:function(e){var t=e.youtube.embed_code,a="";return a+='<div id="'+e.general.id+'" style="'+e.general.css+'" class="'+e.general.classes+'">',t=t.replace("allowfullscreen",""),1==parseInt(e.youtube.allow_fullscreen,10)&&-1==t.indexOf("allowfullscreen")&&(t=t.replace("></iframe>"," allowfullscreen></iframe>")),a+(t=(t=1==parseInt(e.youtube.iframe_auto_width,10)?t.replace(/width="\d+"/g,'width="100%"'):t.replace(/width="\d+"/g,'width="'+e.youtube.iframe_width+'px"')).replace(/height="\d+"/g,'height="'+e.youtube.iframe_height+'px"'))+"</div>"}}),e=(o.squaresRegisterElement&&o.squaresRegisterElement(e),o.squaresRendererRegisterElement(e),{name:"Button",iconClass:"fa fa-link",controls:{button:{text:{name:"Text",type:"text",default:"Button"},link_to:{name:"Link to",type:"text",default:"#"},new_tab:{name:"Open in New Tab",type:"switch",default:0},display:{name:"Display",type:"button group",options:["inline-block","block"],default:"inline-block"},height:{name:"Height",type:"int",default:44},bg_color:{name:"Background Color",type:"color",default:"#2196f3"},text_color:{name:"Text Color",type:"color",default:"#ffffff"},border_radius:{name:"Border Radius",type:"int",default:10},padding:{name:"Padding Left/Right",type:"int",default:20}}},controlGroupIcons:{button:"fa fa-link"},content:function(){var e="",t=(e=(e=(e=(e=(e=(e=(e=(e+="display: "+this.controls.button.display.getVal()+"; ")+("height: "+this.controls.button.height.getVal()+"px; "))+("line-height: "+this.controls.button.height.getVal()+"px; "))+("background-color: "+this.controls.button.bg_color.getVal()+"; "))+("color: "+this.controls.button.text_color.getVal()+"; "))+("border-radius: "+this.controls.button.border_radius.getVal()+"px; "))+("padding-left: "+this.controls.button.padding.getVal()+"px; "))+("padding-right: "+this.controls.button.padding.getVal()+"px; "),"");return 1==parseInt(this.controls.button.new_tab.getVal(),10)&&(t='target="_blank"'),'<div id="'+this.controls.general.id.getVal()+'" style="'+this.controls.general.css.getVal()+'" class="'+this.controls.general.classes.getVal()+'"><a href="'+this.controls.button.link_to.getVal()+'" style="'+e+'" '+t+' class="squares-button">'+this.controls.button.text.getVal()+"</a></div>"},render:function(e){var t="",a=(t=(t=(t=(t=(t=(t=(t=(t+="display: "+e.button.display+"; ")+("height: "+e.button.height+"px; "))+("line-height: "+e.button.height+"px; "))+("background-color: "+e.button.bg_color+"; "))+("color: "+e.button.text_color+"; "))+("border-radius: "+e.button.border_radius+"px; "))+("padding-left: "+e.button.padding+"px; "))+("padding-right: "+e.button.padding+"px; "),"");return 1==parseInt(e.button.new_tab,10)&&(a='target="_blank"'),'<div id="'+e.general.id+'" style="'+e.general.css+'" class="'+e.general.classes+'"><a href="'+e.button.link_to+'" style="'+t+'" '+a+' class="squares-button">'+e.button.text+"</a></div>"}});o.squaresRegisterElement&&o.squaresRegisterElement(e),o.squaresRendererRegisterElement(e)}(jQuery,(window,document));
!function($,window,document,undefined){"use strict";var fullscreenMap=undefined,fullscreenMapParent=undefined,touch="ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints,APIFunctionQueue=($.imageMapProInitialized=function(t){},$.imageMapProEventHighlightedShape=function(t,i){},$.imageMapProEventUnhighlightedShape=function(t,i){},$.imageMapProEventClickedShape=function(t,i){},$.imageMapProEventOpenedTooltip=function(t,i){},$.imageMapProEventClosedTooltip=function(t,i){},$.imageMapProEventSwitchedFloor=function(t,i){},$.imageMapProHighlightShape=function(t,i){var e=findImageMapWithName(t);if(e){t=findShapeWithTitle(e.settings.general.name,i);if(t){var s=t.shape,n=t.index;if(-1===e.apiHighlightedShapes.indexOf(n)&&e.apiHighlightedShapes.push(n),e.connectedShapes[s.id])for(var a=0;a<e.connectedShapes[s.id].length;a++){var o=e.connectedShapes[s.id][a].index;-1===e.apiHighlightedShapes.indexOf(o)&&e.apiHighlightedShapes.push(o)}APIFunctionQueueAddAction(function(t){e.highlightShape(n),t()})}}},$.imageMapProUnhighlightShape=function(t,i){var e=findImageMapWithName(t);if(e){t=findShapeWithTitle(e.settings.general.name,i);if(t){var s=t.shape,n=t.index;if(-1!=e.apiHighlightedShapes.indexOf(n)&&(i=e.apiHighlightedShapes.indexOf(n),e.apiHighlightedShapes.splice(i,1)),e.connectedShapes[s.id])for(var a=0;a<e.connectedShapes[s.id].length;a++){var o=e.connectedShapes[s.id][a].index,h=e.apiHighlightedShapes.indexOf(o);e.apiHighlightedShapes.splice(h,1),APIFunctionQueueAddAction(function(t){e.unhighlightShape(o),t()})}APIFunctionQueueAddAction(function(t){e.unhighlightShape(n),t()})}}},$.imageMapProFocusShape=function(t,i){var e,s,n=findImageMapWithName(t);!n||(t=findShapeWithTitle(n.settings.general.name,i))&&(e=t.shape,s=t.index,parseInt(e.layerID,10)!==parseInt(n.settings.runtime.layerID,10)&&APIFunctionQueueAddAction(function(t){n.switchLayer(e.layerID,function(){t()})}),APIFunctionQueueAddAction(function(t){n.focusShape(s),t()}),APIFunctionQueueAddAction(function(t){n.highlightShape(s),t()}))},$.imageMapProOpenTooltip=function(t,i){var e,s=findImageMapWithName(t);!s||(t=findShapeWithTitle(s.settings.general.name,i))&&(t.shape,e=t.index,APIFunctionQueueAddAction(function(t){s.showTooltip(e),t()}),APIFunctionQueueAddAction(function(t){s.updateTooltipPosition(e),t()}),-1===s.apiOpenedTooltips.indexOf(e)&&s.apiOpenedTooltips.push(e))},$.imageMapProHideTooltip=function(t,i){var e,s=findImageMapWithName(t);!s||(t=findShapeWithTitle(s.settings.general.name,i))&&(t.shape,e=t.index,-1!=s.apiOpenedTooltips.indexOf(e)&&(i=s.apiOpenedTooltips.indexOf(e),s.apiOpenedTooltips.splice(i,1)),APIFunctionQueueAddAction(function(t){s.hideTooltip(e),t()}))},$.imageMapProReInitMap=function(t){t=findImageMapWithName(t);t&&t.init()},$.imageMapProIsMobile=function(){return isMobile()},$.imageMapProGoToFloor=function(t,i){var e=instances[t+"-fullscreen"]||instances[t];if(e){for(var s=0,n=0;n<e.settings.layers.layers_list.length;n++)e.settings.layers.layers_list[n].title===i&&(s=e.settings.layers.layers_list[n].id);APIFunctionQueueAddAction(function(t){e.switchLayer(s),t()})}},$.imageMapProZoomIn=function(t){t=findImageMapWithName(t);t&&t.zoomIn()},$.imageMapProZoomOut=function(t){t=findImageMapWithName(t);t&&t.zoomOut()},[]);function findShapeWithTitle(t,i){var e=$('[data-shape-title="'+i+'"]').data("index"),s=instances[t].settings.spots[e];if(!s){for(var n=0;n<instances[t].settings.spots.length;n++)instances[t].settings.spots[n].title===i&&(s=instances[t].settings.spots[n],e=n);if(!s)return console.log("Error: Could not find shape with name: "+i),undefined}return{shape:s,index:e}}function findImageMapWithName(t){for(var i in instances)if(instances[i].settings.general.name===t)return instances[i];for(var i in console.log('Image map with name "'+t+'" not found, returning the first found image map instead.'),instances)return instances[i];return console.log("Error: No image maps found!"),undefined}function APIFunctionQueueAddAction(t){var i=APIFunctionQueue.length;APIFunctionQueue.push(t),0===i&&APIFunctionQueuePopAction()}function APIFunctionQueuePopAction(){APIFunctionQueue[0](function(){APIFunctionQueue.shift(),0<APIFunctionQueue.length&&APIFunctionQueuePopAction()})}$(document).ready(function(){$(document).on("mouseover","[data-imp-highlight-shape-on-mouseover]",function(){var i,t=$(this).data("imp-highlight-shape-on-mouseover"),e=findImageMapWithName($(this).data("imp-image-map-name"));!e||(t=findShapeWithTitle(e.settings.general.name,t))&&(t.shape,i=t.index,APIFunctionQueueAddAction(function(t){e.highlightShape(i,!0),t()}))}),$(document).on("mouseout","[data-imp-highlight-shape-on-mouseover]",function(){var t=$(this).data("imp-highlight-shape-on-mouseover"),i=findImageMapWithName($(this).data("imp-image-map-name"));!i||(t=findShapeWithTitle(i.settings.general.name,t))&&(t.shape,t.index,APIFunctionQueueAddAction(function(t){i.unhighlightAllShapes(),t()}))}),$(document).on("click","[data-imp-highlight-shape-on-click]",function(){var t=$(this).data("imp-highlight-shape-on-click"),i=findImageMapWithName($(this).data("imp-image-map-name"));if(i){t=findShapeWithTitle(i.settings.general.name,t);if(t){var e=t.shape,s=t.index;if(parseInt(e.layerID,10)!==parseInt(i.settings.runtime.layerID,10)&&APIFunctionQueueAddAction(function(t){i.switchLayer(e.layerID,function(){t()})}),APIFunctionQueueAddAction(function(t){i.highlightShape(s,!0),t()}),-1===i.apiHighlightedShapes.indexOf(s)&&i.apiHighlightedShapes.push(s),i.connectedShapes[e.id])for(var n=0;n<i.connectedShapes[e.id].length;n++){var a=i.connectedShapes[e.id][n].index;-1===i.apiHighlightedShapes.indexOf(a)&&i.apiHighlightedShapes.push(a)}}}}),$(document).on("mouseover","[data-imp-unhighlight-shape-on-mouseover]",function(){var t=$(this).data("imp-unhighlight-shape-on-mouseover"),i=findImageMapWithName($(this).data("imp-image-map-name"));if(i){t=findShapeWithTitle(i.settings.general.name,t);if(t){var e=t.shape,s=t.index;if(-1!=i.apiHighlightedShapes.indexOf(s)&&(t=i.apiHighlightedShapes.indexOf(s),i.apiHighlightedShapes.splice(t,1)),parseInt(e.layerID,10)!==parseInt(i.settings.runtime.layerID,10)&&APIFunctionQueueAddAction(function(t){i.switchLayer(e.layerID,function(){t()})}),i.connectedShapes[e.id])for(var n=0;n<i.connectedShapes[e.id].length;n++){var a=i.connectedShapes[e.id][n].index,o=i.apiHighlightedShapes.indexOf(a);i.apiHighlightedShapes.splice(o,1),APIFunctionQueueAddAction(function(t){i.unhighlightShape(a),t()})}APIFunctionQueueAddAction(function(t){i.unhighlightShape(s),t()})}}}),$(document).on("click","[data-imp-unhighlight-shape-on-click]",function(){var t=$(this).data("imp-unhighlight-shape-on-click"),i=findImageMapWithName($(this).data("imp-image-map-name"));if(i){t=findShapeWithTitle(i.settings.general.name,t);if(t){var e=t.shape,s=t.index;if(-1!=i.apiHighlightedShapes.indexOf(s)&&(t=i.apiHighlightedShapes.indexOf(s),i.apiHighlightedShapes.splice(t,1)),parseInt(e.layerID,10)!==parseInt(i.settings.runtime.layerID,10)&&APIFunctionQueueAddAction(function(t){i.switchLayer(e.layerID,function(){t()})}),i.connectedShapes[e.id])for(var n=0;n<i.connectedShapes[e.id].length;n++){var a=i.connectedShapes[e.id][n].index,o=i.apiHighlightedShapes.indexOf(a);i.apiHighlightedShapes.splice(o,1),APIFunctionQueueAddAction(function(t){i.unhighlightShape(a),t()})}APIFunctionQueueAddAction(function(t){i.unhighlightShape(s),t()})}}}),$(document).on("mouseover","[data-imp-open-tooltip-on-mouseover]",function(){var i,e,t=$(this).data("imp-open-tooltip-on-mouseover"),s=findImageMapWithName($(this).data("imp-image-map-name"));!s||(t=findShapeWithTitle(s.settings.general.name,t))&&(i=t.shape,e=t.index,parseInt(i.layerID,10)!==parseInt(s.settings.runtime.layerID,10)&&APIFunctionQueueAddAction(function(t){s.switchLayer(i.layerID,function(){t()})}),APIFunctionQueueAddAction(function(t){s.showTooltip(e),t()}),APIFunctionQueueAddAction(function(t){s.updateTooltipPosition(e),t()}),-1===s.apiOpenedTooltips.indexOf(e)&&s.apiOpenedTooltips.push(e))}),$(document).on("mouseout","[data-imp-open-tooltip-on-mouseover]",function(){var i,t=$(this).data("imp-open-tooltip-on-mouseover"),e=findImageMapWithName($(this).data("imp-image-map-name"));!e||(t=findShapeWithTitle(e.settings.general.name,t))&&(i=t.shape,t=t.index,parseInt(i.layerID,10)!==parseInt(e.settings.runtime.layerID,10)&&APIFunctionQueueAddAction(function(t){e.switchLayer(i.layerID,function(){t()})}),APIFunctionQueueAddAction(function(t){e.hideAllTooltips(),t()}),-1!=e.apiOpenedTooltips.indexOf(t)&&(t=e.apiOpenedTooltips.indexOf(t),e.apiOpenedTooltips.splice(t,1)))}),$(document).on("click","[data-imp-open-tooltip-on-click]",function(){var i,e,t=$(this).data("imp-open-tooltip-on-click"),s=findImageMapWithName($(this).data("imp-image-map-name"));!s||(t=findShapeWithTitle(s.settings.general.name,t))&&(i=t.shape,e=t.index,parseInt(i.layerID,10)!==parseInt(s.settings.runtime.layerID,10)&&APIFunctionQueueAddAction(function(t){s.switchLayer(i.layerID,function(){t()})}),APIFunctionQueueAddAction(function(t){s.showTooltip(e),t()}),APIFunctionQueueAddAction(function(t){s.updateTooltipPosition(e),t()}),-1===s.apiOpenedTooltips.indexOf(e)&&s.apiOpenedTooltips.push(e))}),$(document).on("mouseover","[data-imp-close-tooltip-on-mouseover]",function(){var i,e,t=$(this).data("imp-close-tooltip-on-mouseover"),s=findImageMapWithName($(this).data("imp-image-map-name"));!s||(t=findShapeWithTitle(s.settings.general.name,t))&&(i=t.shape,e=t.index,parseInt(i.layerID,10)!==parseInt(s.settings.runtime.layerID,10)&&APIFunctionQueueAddAction(function(t){s.switchLayer(i.layerID,function(){t()})}),-1!=s.apiOpenedTooltips.indexOf(e)&&(t=s.apiOpenedTooltips.indexOf(e),s.apiOpenedTooltips.splice(t,1)),APIFunctionQueueAddAction(function(t){s.hideTooltip(e),t()}))}),$(document).on("click","[data-imp-close-tooltip-on-click]",function(){var i,e,t=$(this).data("imp-close-tooltip-on-click"),s=findImageMapWithName($(this).data("imp-image-map-name"));!s||(t=findShapeWithTitle(s.settings.general.name,t))&&(i=t.shape,e=t.index,parseInt(i.layerID,10)!==parseInt(s.settings.runtime.layerID,10)&&APIFunctionQueueAddAction(function(t){s.switchLayer(i.layerID,function(){t()})}),-1!=s.apiOpenedTooltips.indexOf(e)&&(t=s.apiOpenedTooltips.indexOf(e),s.apiOpenedTooltips.splice(t,1)),APIFunctionQueueAddAction(function(t){s.hideTooltip(e),t()}))}),$(document).on("mouseover","[data-imp-trigger-shape-on-mouseover]",function(){var t=$(this).data("imp-trigger-shape-on-mouseover"),i=findImageMapWithName($(this).data("imp-image-map-name"));if(i){t=findShapeWithTitle(i.settings.general.name,t);if(t){var e=t.shape,s=t.index;if(parseInt(e.layerID,10)!==parseInt(i.settings.runtime.layerID,10)&&APIFunctionQueueAddAction(function(t){i.switchLayer(e.layerID,function(){t()})}),APIFunctionQueueAddAction(function(t){i.highlightShape(s,!0),t()}),APIFunctionQueueAddAction(function(t){i.showTooltip(s),t()}),APIFunctionQueueAddAction(function(t){i.updateTooltipPosition(s),t()}),-1===i.apiOpenedTooltips.indexOf(s)&&i.apiOpenedTooltips.push(s),-1===i.apiHighlightedShapes.indexOf(s)&&i.apiHighlightedShapes.push(s),i.connectedShapes[e.id])for(var n=0;n<i.connectedShapes[e.id].length;n++){var a=i.connectedShapes[e.id][n].index;-1===i.apiHighlightedShapes.indexOf(a)&&i.apiHighlightedShapes.push(a)}}}}),$(document).on("mouseout","[data-imp-trigger-shape-on-mouseover]",function(){var t=$(this).data("imp-trigger-shape-on-mouseover"),i=findImageMapWithName($(this).data("imp-image-map-name"));if(i){t=findShapeWithTitle(i.settings.general.name,t);if(t){var e,s=t.shape,n=t.index;if(parseInt(s.layerID,10)!==parseInt(i.settings.runtime.layerID,10)&&APIFunctionQueueAddAction(function(t){i.switchLayer(s.layerID,function(){t()})}),-1!=i.apiHighlightedShapes.indexOf(n)&&(e=i.apiHighlightedShapes.indexOf(n),i.apiHighlightedShapes.splice(e,1)),i.connectedShapes[s.id])for(var a=0;a<i.connectedShapes[s.id].length;a++){var o=i.connectedShapes[s.id][a].index,h=i.apiHighlightedShapes.indexOf(o);i.apiHighlightedShapes.splice(h,1),APIFunctionQueueAddAction(function(t){i.unhighlightShape(o),t()})}APIFunctionQueueAddAction(function(t){i.unhighlightShape(n),t()}),-1!=i.apiOpenedTooltips.indexOf(n)&&(e=i.apiOpenedTooltips.indexOf(n),i.apiOpenedTooltips.splice(e,1)),APIFunctionQueueAddAction(function(t){i.hideTooltip(n),t()})}}}),$(document).on("click","[data-imp-trigger-shape-on-click]",function(){var t=$(this).data("imp-trigger-shape-on-click"),i=findImageMapWithName($(this).data("imp-image-map-name"));if(i){t=findShapeWithTitle(i.settings.general.name,t);if(t){var e=t.shape,s=t.index;if(parseInt(e.layerID,10)!==parseInt(i.settings.runtime.layerID,10)&&APIFunctionQueueAddAction(function(t){i.switchLayer(e.layerID,function(){t()})}),APIFunctionQueueAddAction(function(t){i.highlightShape(s,!0),t()}),APIFunctionQueueAddAction(function(t){i.showTooltip(s),t()}),APIFunctionQueueAddAction(function(t){i.updateTooltipPosition(s),t()}),-1===i.apiOpenedTooltips.indexOf(s)&&i.apiOpenedTooltips.push(s),-1===i.apiHighlightedShapes.indexOf(s)&&i.apiHighlightedShapes.push(s),i.connectedShapes[e.id])for(var n=0;n<i.connectedShapes[e.id].length;n++){var a=i.connectedShapes[e.id][n].index;-1===i.apiHighlightedShapes.indexOf(a)&&i.apiHighlightedShapes.push(a)}}}}),$(document).on("mouseover","[data-imp-untrigger-shape-on-mouseover]",function(){var t=$(this).data("imp-untrigger-shape-on-mouseover"),i=findImageMapWithName($(this).data("imp-image-map-name"));if(i){t=findShapeWithTitle(i.settings.general.name,t);if(t){var e,s=t.shape,n=t.index;if(parseInt(s.layerID,10)!==parseInt(i.settings.runtime.layerID,10)&&APIFunctionQueueAddAction(function(t){i.switchLayer(s.layerID,function(){t()})}),-1!=i.apiHighlightedShapes.indexOf(n)&&(e=i.apiHighlightedShapes.indexOf(n),i.apiHighlightedShapes.splice(e,1)),i.connectedShapes[s.id])for(var a=0;a<i.connectedShapes[s.id].length;a++){var o=i.connectedShapes[s.id][a].index,h=i.apiHighlightedShapes.indexOf(o);i.apiHighlightedShapes.splice(h,1),APIFunctionQueueAddAction(function(t){i.unhighlightShape(o),t()})}APIFunctionQueueAddAction(function(t){i.unhighlightShape(n),t()}),-1!=i.apiOpenedTooltips.indexOf(n)&&(e=i.apiOpenedTooltips.indexOf(n),i.apiOpenedTooltips.splice(e,1)),APIFunctionQueueAddAction(function(t){i.hideTooltip(n),t()})}}}),$(document).on("click","[data-imp-untrigger-shape-on-click]",function(){var t=$(this).data("imp-untrigger-shape-on-click"),i=findImageMapWithName($(this).data("imp-image-map-name"));if(i){t=findShapeWithTitle(i.settings.general.name,t);if(t){var e,s=t.shape,n=t.index;if(parseInt(s.layerID,10)!==parseInt(i.settings.runtime.layerID,10)&&APIFunctionQueueAddAction(function(t){i.switchLayer(s.layerID,function(){t()})}),-1!=i.apiHighlightedShapes.indexOf(n)&&(e=i.apiHighlightedShapes.indexOf(n),i.apiHighlightedShapes.splice(e,1)),i.connectedShapes[s.id])for(var a=0;a<i.connectedShapes[s.id].length;a++){var o=i.connectedShapes[s.id][a].index,h=i.apiHighlightedShapes.indexOf(o);i.apiHighlightedShapes.splice(h,1),APIFunctionQueueAddAction(function(t){i.unhighlightShape(o),t()})}APIFunctionQueueAddAction(function(t){i.unhighlightShape(n),t()}),-1!=i.apiOpenedTooltips.indexOf(n)&&(e=i.apiOpenedTooltips.indexOf(n),i.apiOpenedTooltips.splice(e,1)),APIFunctionQueueAddAction(function(t){i.hideTooltip(n),t()})}}}),$(document).on("mouseover","[data-imp-focus-shape-on-mouseover]",function(){var i,e,t=$(this).data("imp-focus-shape-on-mouseover"),s=findImageMapWithName($(this).data("imp-image-map-name"));!s||(t=findShapeWithTitle(s.settings.general.name,t))&&(i=t.shape,e=t.index,parseInt(i.layerID,10)!==parseInt(s.settings.runtime.layerID,10)&&APIFunctionQueueAddAction(function(t){s.switchLayer(i.layerID,function(){t()})}),APIFunctionQueueAddAction(function(t){s.focusShape(e),t()}),APIFunctionQueueAddAction(function(t){s.unhighlightAllShapes(),t()}),APIFunctionQueueAddAction(function(t){s.highlightShape(e),t()}))}),$(document).on("click","[data-imp-focus-shape-on-click]",function(){var i,e,t=$(this).data("imp-focus-shape-on-click"),s=findImageMapWithName($(this).data("imp-image-map-name"));!s||(t=findShapeWithTitle(s.settings.general.name,t))&&(i=t.shape,e=t.index,s.hideResponsiveShapesMenu(),parseInt(i.layerID,10)!==parseInt(s.settings.runtime.layerID,10)&&APIFunctionQueueAddAction(function(t){s.switchLayer(i.layerID,function(){t()})}),APIFunctionQueueAddAction(function(t){s.focusShape(e),t()}),APIFunctionQueueAddAction(function(t){s.unhighlightAllShapes(),t()}),APIFunctionQueueAddAction(function(t){s.highlightShape(e),t()}))}),$(document).on("click","[data-imp-go-to-floor]",function(){var t=$(this).data("imp-go-to-floor"),i=findImageMapWithName($(this).data("imp-image-map-name"));if(i){for(var e=0,s=0;s<i.settings.layers.layers_list.length;s++)i.settings.layers.layers_list[s].title===t&&(e=i.settings.layers.layers_list[s].id);i.switchLayer(e)}})});var pluginName="imageMapPro",default_settings=$.imageMapProEditorDefaults,default_spot_settings=$.imageMapProShapeDefaults,instances=new Array;function Plugin(t,i){this.element=t,this.settings=$.extend(!0,{},default_settings,i),this.root=$(t),this.wrap=undefined,this.shapesMenuWrap=undefined,this.shapesMenuResponsiveButton=undefined,this.zoomWrap=undefined,this.translateWrap=undefined,this.ui=undefined,this.uiNavigatorRoot=undefined,this.uiNavigatorWindowWidth=undefined,this.uiNavigatorWindowHeight=undefined,this.uiNavigatorImage=undefined,this.shapeContainer=undefined,this.imageBackgroundsContainer=undefined,this.shapeSvgContainer=undefined,this.fullscreenTooltipsContainer=undefined,this.tooltipsContainer=undefined,this.scrollMessage=undefined,this.responsiveShapesMenu=!1,this.responsiveShapesMenuWrap=!1,this.wrapWidth=0,this.wrapHeight=0,this.wrapOffsetLeft=0,this.wrapOffsetTop=0,this.visibleFullscreenTooltip=undefined,this.visibleFullscreenTooltipIndex=undefined,this.bodyOverflow=undefined,this.highlightedShapes=new Array,this.connectedShapes=new Array,this.openedTooltips=new Array,this.apiHighlightedShapes=new Array,this.apiOpenedTooltips=new Array,this.hideScrollMessageTimeout=undefined,this.targetZoom=1,this.zoom=1,this.maxZoomLevel=8,this.zoomMultiplier=1.45,this.targetPanX=0,this.actualPanX=0,this.targetPanY=0,this.actualPanY=0,this.initialPanX=0,this.initialPanY=0,this.panDeltaY=0,this.ix=0,this.iy=0,this.lastX=0,this.lastY=0,this.pinchInitial=[{x:0,y:0},{x:0,y:0}],this.pinchInitialDistance=0,this.pinchInitialZoom=0,this.navigatorRatio=1,this.navigatorMarginX=0,this.navigatorMarginY=0,this.touch=!1,this.fullscreenTooltipVisible=!1,this.panning=!1,this.didPan=!1,this.panningOnNavigator=!1,this.pinching=!1,this.didAnimateShapesOnPageload=!1,this.ctrlKeyDown=!1,this.cmdKeyDown=!1,this.mac=!1,this.lastWrapRecalc=0,this.init()}function isTrue(t){return 1===parseInt(t,10)}function hexToRgb(t){t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:0,g:0,b:0}}function screenToImageMapSpace(t,i,e){Math.round(1e3*(t-e.offset().left)),Math.round(1e3*(i-e.offset().top))}function isPointInsideRect(t,i,e,s,n,a){return e<=t&&t<=e+n&&s<=i&&i<=s+a}function isPointInsidePolygon(t,i,e){for(var s=!1,n=0,a=e.length-1;n<e.length;a=n++){var o=e[n][0],h=e[n][1],r=e[a][0],p=e[a][1];i<h!=i<p&&t<(r-o)*(i-h)/(p-h)+o&&(s=!s)}return s}function isPointInsideEllipse(t,i,e,s,n,a){return(t-e)*(t-e)/(n*n)+(i-s)*(i-s)/(a*a)<=1}function fitRectToScreen(t,i,e,s){return i<0&&(i=0),{x:t=(t=t<0?0:t)>$(document).width()-e?$(document).width()-e:t,y:i=i>$(document).height()-s?$(document).height()-s:i}}function shuffle(t){for(var i,e,s=t.length;0!==s;)e=Math.floor(Math.random()*s),i=t[--s],t[s]=t[e],t[e]=i;return t}function isMobile(){return!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function lerp(t,i,e){return t*(1-e)+i*e}function easeOutBounce(t,i,e,s,n){return(i/=n)<1/2.75?s*(7.5625*i*i)+e:i<2/2.75?s*(7.5625*(i-=1.5/2.75)*i+.75)+e:i<2.5/2.75?s*(7.5625*(i-=2.25/2.75)*i+.9375)+e:s*(7.5625*(i-=2.625/2.75)*i+.984375)+e}$.extend(Plugin.prototype,{init:function(t){this.parseSettings(),(instances[this.settings.general.name]=this).id=100*Math.random(),this.connectedShapes=[];for(var i,e=0;e<this.settings.spots.length;e++){var s=this.settings.spots[e],n=$.extend(!0,{},default_spot_settings);s=$.extend(!0,n,s),this.settings.spots[e]=$.extend(!0,{},s),this.settings.spots[e].title&&0!==this.settings.spots[e].title.length||(this.settings.spots[e].title=this.settings.spots[e].id),""!=s.connected_to&&(this.connectedShapes[s.connected_to]||(this.connectedShapes[s.connected_to]=new Array),this.connectedShapes[s.connected_to].push({id:s.id,index:e})),this.settings.spots[e].mouseover_style.background_type=this.settings.spots[e].default_style.background_type}if(isTrue(this.settings.layers.enable_layers)){for(var a=!1,e=0;e<this.settings.layers.layers_list.length;e++)parseInt(this.settings.layers.layers_list[e].id,10)===parseInt(this.settings.runtime.layerID,10)&&(a=!0,this.settings.image.url=this.settings.layers.layers_list[e].image_url);a||(this.settings.image.url=this.settings.layers.layers_list[0].image_url,this.settings.runtime.layerID=this.settings.layers.layers_list[0].id)}this.mac=0<=navigator.platform.toUpperCase().indexOf("MAC"),""!=this.settings.image.url?((o=new Image).src=this.settings.image.url,(i=this).loadImage(o,function(){},function(){i.finishInit(t)})):this.finishInit(t);for(var o,e=0;e<this.settings.spots.length;e++)"image"===(s=this.settings.spots[e]).default_style.background_type&&((o=new Image).src=s.mouseover_style.background_image_url,$(o).on("load",function(){}))},finishInit:function(t){var i=this.root.width();this.settings.runtime.is_fullscreen&&(i=$(window).width()),(isMobile()||i/3<240)&&(this.responsiveShapesMenu=!0);var i="";if(e=(e="")+('<div class="imp-wrap '+(i=isTrue(this.settings.tooltips.sticky_tooltips)?"imp-sticky-tooltips":i)+'">')+('   <div class="imp-ui" data-image-map-pro-ui-id="'+this.settings.id+'">'),isTrue(this.settings.zooming.enable_zooming)&&isTrue(this.settings.zooming.enable_navigator)&&(e+='       <div data-imp-id="'+this.settings.id+'" class="imp-ui-element imp-ui-navigator-root">',""!=this.settings.image.url&&(e=(e+='         <img src="'+this.settings.image.url+'" class="imp-ui-navigator-background-image-edgefill">')+'         <img src="'+this.settings.image.url+'" class="imp-ui-navigator-background-image">'),e+='         <div class="imp-ui-navigator-overlay"></div>',""!=this.settings.image.url&&(e+='         <img src="'+this.settings.image.url+'" class="imp-ui-navigator-window-image" draggable="false">'),e+="      </div>"),isTrue(this.settings.zooming.enable_zooming)&&isTrue(this.settings.zooming.enable_zoom_buttons)&&(e=(e+='       <div data-imp-id="'+this.settings.id+'" class="imp-ui-element imp-ui-zoom-button imp-ui-zoom-button-zoom-in" style="color: '+this.settings.zooming.zoom_button_text_color+"; background: "+this.settings.zooming.zoom_button_background_color+';"><i class="fa fa-plus"></i></div>')+'       <div data-imp-id="'+this.settings.id+'" class="imp-ui-element imp-ui-zoom-button imp-ui-zoom-button-zoom-out" style="color: '+this.settings.zooming.zoom_button_text_color+"; background: "+this.settings.zooming.zoom_button_background_color+';"><i class="fa fa-minus"></i></div>'),isTrue(this.settings.layers.enable_layers)){for(var e=(e=e+'<div class="imp-ui-layers-menu-wrap">'+('   <div data-imp-id="'+this.settings.id+'" class="imp-ui-layer-switch-up imp-ui-layer-switch"><i class="fa fa-caret-up" aria-hidden="true"></i></div>'))+('   <div data-imp-id="'+this.settings.id+'" class="imp-ui-layer-switch-down imp-ui-layer-switch"><i class="fa fa-caret-down" aria-hidden="true"></i></div>')+'   <select class="imp-ui-element imp-ui-layers-select">',s=0;s<this.settings.layers.layers_list.length;s++)e+='<option value="'+this.settings.layers.layers_list[s].id+'">'+this.settings.layers.layers_list[s].title+"</option>";e=e+"   </select>"+"</div>"}isTrue(this.settings.zooming.enable_zooming)&&isTrue(this.settings.zooming.hold_ctrl_to_zoom)&&(i="CTRL",e=(e+='<div class="imp-ui-scroll-message-wrap">')+'   <div class="imp-ui-scroll-message-wrap-inner">       <div class="imp-ui-scroll-message">Hold <div class="imp-ui-scroll-message-button">'+(i=this.mac?"⌘":i)+"</div> to Zoom</div>   </div></div>"),e+='   </div>   <div class="imp-zoom-outer-wrap">       <div class="imp-translate-wrap">           <div class="imp-zoom-wrap">',""!=this.settings.image.url&&(e+='               <img src="'+this.settings.image.url+'" class="imp-main-image">'),this.root.html(e=(e=e+"           </div>"+"       </div>")+"   </div>"+"</div>"),this.wrap=this.root.find(".imp-wrap"),this.zoomWrap=this.root.find(".imp-zoom-wrap"),this.translateWrap=this.root.find(".imp-translate-wrap"),this.ui=this.wrap.find(".imp-ui"),this.scrollMessage=this.wrap.find(".imp-ui-scroll-message-wrap"),this.root.addClass("imp-initialized"),this.root.attr("data-image-map-pro-id",this.settings.id),$('[data-imp-tooltips-container="'+this.settings.id+'"]').remove(),$("body").prepend('<div class="imp-tooltips-container" data-imp-tooltips-container="'+this.settings.id+'"></div>'),this.tooltipsContainer=$('[data-imp-tooltips-container="'+this.settings.id+'"]'),this.events(),this.centerImageMap(),this.drawShapes(),this.generateShapeStyleClasses(),this.addTooltips(),this.initFullscreen(),this.initZoom(),this.drawShapesMenu(),this.adjustSize(),this.initNavigator(),this.initLayers(),this.animateShapesLoop(),$.imageMapProInitialized(this.settings.general.name),t&&t()},parseSettings:function(){this.settings.general.image_url&&(this.settings.image.url=this.settings.general.image_url);for(var t=0;t<this.settings.spots.length;t++){var i,e=this.settings.spots[t];e.tooltip_style&&e.tooltip_style.enable_tooltip&&(e.tooltip.enable_tooltip=e.tooltip_style.enable_tooltip,e.tooltip_style.enable_tooltip=undefined),e.tooltip_content.plain_text&&"content-builder"!=e.tooltip_content.content_type&&(i={containers:[{id:"sq-container-160121",settings:{elements:[{settings:{name:"Paragraph",iconClass:"fa fa-paragraph"},options:{text:{text:e.tooltip_content.plain_text},font:{text_color:e.tooltip_content.plain_text_color}}}]}}]},e.tooltip_content.squares_settings=i,e.tooltip_content.content_type=undefined,e.tooltip_content.plain_text=undefined,e.tooltip_content.plain_text_color=undefined),e.default_style&&e.default_style.fill&&(e.default_style.background_color=e.default_style.fill,delete e.default_style.fill),e.default_style&&e.default_style.fill_opacity&&(e.default_style.background_opacity=e.default_style.fill_opacity,delete e.default_style.fill_opacity),e.mouseover_style&&e.mouseover_style.fill&&(e.mouseover_style.background_color=e.mouseover_style.fill,delete e.mouseover_style.fill),e.mouseover_style&&e.mouseover_style.fill_opacity&&(e.mouseover_style.background_opacity=e.mouseover_style.fill_opacity,delete e.mouseover_style.fill_opacity)}},loadImage:function(t,i,e){if(isTrue(this.settings.layers.enable_layers))for(var s=0;s<this.settings.layers.layers_list.length;s++){var n=new Image,a=(n.src=this.settings.layers.layers_list[s].image_url,0),o=this;$(n).on("load",function(){++a===o.settings.layers.layers_list.length&&e()})}else t.complete&&t.naturalWidth!==undefined&&t.naturalHeight!==undefined?e():(i(),$(t).on("load",function(){$(t).off("load"),e()}))},centerImageMap:function(){isTrue(this.settings.general.center_image_map)&&this.wrap.css({margin:"0 auto"})},adjustSize:function(){var t,i,e;if(isTrue(this.settings.runtime.is_fullscreen))return t=$(window).width(),i=$(window).height(),isTrue(this.settings.shapes_menu.enable_shapes_menu)&&!this.responsiveShapesMenu&&(t-=240),(e=this.settings.general.naturalWidth/this.settings.general.naturalHeight)<t/i?(this.settings.general.width=i*e,this.settings.general.height=i):(this.settings.general.width=t,this.settings.general.height=t/e),this.wrap.css({width:this.settings.general.width,height:this.settings.general.height}),this.wrapWidth=this.wrap.width(),this.wrapHeight=this.wrap.height(),this.wrapOffsetLeft=this.wrap.offset().left,void(this.wrapOffsetTop=this.wrap.offset().top);""!=this.settings.image.url?isTrue(this.settings.general.responsive)?isTrue(this.settings.general.preserve_quality)&&this.wrap.css({"max-width":this.settings.general.naturalWidth}):this.wrap.css({width:this.settings.general.width,height:this.settings.general.height}):isTrue(this.settings.general.responsive)?(this.wrap.css({width:"100%",height:this.settings.general.height,"max-width":this.settings.general.width,"max-height":this.settings.general.height}),this.wrap.css({height:this.wrap.width()*(this.settings.general.height/this.settings.general.width)})):this.wrap.css({width:this.settings.general.width,height:this.settings.general.height}),this.wrapWidth=this.wrap.width(),this.wrapHeight=this.wrap.height(),this.wrapOffsetLeft=this.wrap.offset().left,this.wrapOffsetTop=this.wrap.offset().top,isTrue(this.settings.shapes_menu.enable_shapes_menu)&&!isTrue(this.settings.shapes_menu.detached_menu)&&(isTrue(this.settings.shapes_menu.enable_search)?this.shapesMenuWrap.height(this.wrap.height()-73):this.shapesMenuWrap.height(this.wrap.height()))},drawShapes:function(){for(var t=0;t<this.settings.spots.length;t++)if((m=this.settings.spots[t]).x=parseFloat(m.x),m.y=parseFloat(m.y),m.width=parseFloat(m.width),m.height=parseFloat(m.height),m.default_style.stroke_width=parseInt(m.default_style.stroke_width),m.mouseover_style.stroke_width=parseInt(m.mouseover_style.stroke_width),"poly"===m.type)for(var i=0;i<m.points.length;i++)m.points[i].x=parseFloat(m.points[i].x),m.points[i].y=parseFloat(m.points[i].y);this.settings.general.width=parseInt(this.settings.general.width),this.settings.general.height=parseInt(this.settings.general.height),this.zoomWrap.prepend('<div class="imp-shape-container"></div>'),this.zoomWrap.prepend('<div class="imp-image-backgrounds-container" id="imp-image-backgrounds-container-'+this.settings.id+'"></div>'),this.shapeContainer=this.wrap.find(".imp-shape-container"),this.imageBackgroundsContainer=this.wrap.find(".imp-image-backgrounds-container");for(var e="",s=this.settings.general.width,n=this.settings.general.height,a=(isTrue(this.settings.general.responsive)&&(s=this.settings.general.naturalWidth,n=this.settings.general.naturalHeight),'<svg class="hs-poly-svg" viewBox="0 0 '+s+" "+n+'" preserveAspectRatio="none">'),t=0;t<this.settings.spots.length;t++)if(!isTrue(this.settings.layers.enable_layers)||parseInt(this.settings.spots[t].layerID,10)===parseInt(this.settings.runtime.layerID)){var o,h,r,p,l="";if(isTrue((m=this.settings.spots[t]).static)&&(l="imp-shape-static"),"spot"===m.type&&(isTrue(m.default_style.use_icon)?(o="imp-shape-spot",isTrue(m.default_style.icon_is_pin)&&(o+=" imp-shape-spot-pin"),e+='<div class="imp-shape '+l+" "+o+'" id="'+m.id+'" data-shape-title="'+m.title+'" data-index='+t+">","library"===m.default_style.icon_type&&(o="",e=(e+='   <div class="imp-spot-fontawesome-icon" style="'+(o=(o+="line-height: "+m.height+"px;")+("font-size: "+m.height+"px;"))+'">')+'       <i class="fa fa-'+m.default_style.icon_fontawesome_id+'"></i>   </div>'),"custom"===m.default_style.icon_type&&0<m.default_style.icon_url.length&&(e+='<img src="'+m.default_style.icon_url+'" style="width: '+m.width+"px; height: "+m.height+'px">'),isTrue(m.default_style.icon_shadow)&&(o="",e+='<div style="'+(o=(o=(o+="width: "+m.width+"px;")+("height: "+m.height+"px;"))+("top: "+m.height/2+"px;"))+'" class="imp-shape-icon-shadow"></div>'),isTrue(this.settings.shapes.glowing_shapes)&&(r="",r=(r=(r=(r=(r+="width: "+m.width/3+"px;")+"height: "+m.height/3+"px;")+"margin-left: "+-m.width/6+"px;")+"margin-top: "+-m.height/6+"px;")+"border-radius: "+m.width/3+"px;",e+='<div class="imp-spot-glow" style="'+(r=(r+="background: rgba("+(p=hexToRgb(this.settings.shapes.glowing_shapes_color)||{r:0,b:0,g:0}).r+", "+p.g+", "+p.b+", "+this.settings.shapes.glow_opacity+");")+("box-shadow: 0 0 20px 15px rgba("+p.r+", "+p.g+", "+p.b+", "+this.settings.shapes.glow_opacity+");"))+'"></div>'),e+="</div>"):(h="",isTrue(this.settings.shapes.glowing_shapes)&&(h+='<div class="imp-shape-glow" style="'+(r=(r="")+("box-shadow: 0 0 20px 15px rgba("+(p=hexToRgb(this.settings.shapes.glowing_shapes_color)||{r:0,b:0,g:0}).r+", "+p.g+", "+p.b+", "+this.settings.shapes.glow_opacity+");")+"border-radius: 50% 50%;")+'"></div>'),e+='<div class="imp-shape '+l+' imp-shape-spot" id="'+m.id+'" data-shape-title="'+m.title+'" data-index='+t+">"+h+"</div>")),"text"===m.type&&(e+='<div class="imp-shape '+l+' imp-shape-text" id="'+m.id+'" data-shape-title="'+m.title+'" data-index='+t+">"+m.text.text+"</div>"),"rect"===m.type&&(h="",isTrue(this.settings.shapes.glowing_shapes)&&(r="",h+='<div class="imp-shape-glow" style="'+(r=(r+="box-shadow: 0 0 20px 15px rgba("+(p=hexToRgb(this.settings.shapes.glowing_shapes_color)||{r:0,b:0,g:0}).r+", "+p.g+", "+p.b+", "+this.settings.shapes.glow_opacity+");")+("border-radius: "+m.default_style.border_radius+"px;"))+'"></div>'),e+='<div class="imp-shape '+l+' imp-shape-rect" id="'+m.id+'" data-shape-title="'+m.title+'" data-index='+t+">"+h+"</div>"),"oval"===m.type&&(h="",isTrue(this.settings.shapes.glowing_shapes)&&(h+='<div class="imp-shape-glow" style="'+(r=(r="")+("box-shadow: 0 0 20px 15px rgba("+(p=hexToRgb(this.settings.shapes.glowing_shapes_color)||{r:0,b:0,g:0}).r+", "+p.g+", "+p.b+", "+this.settings.shapes.glow_opacity+");")+"border-radius: 50% 50%;")+'"></div>'),e+='<div class="imp-shape '+l+' imp-shape-oval" id="'+m.id+'" data-shape-title="'+m.title+'" data-index='+t+">"+h+"</div>"),"poly"===m.type){if(m.points.length<3)continue;a+='<polygon class="imp-shape '+l+' imp-shape-poly" data-index='+t+' id="'+m.id+'" data-shape-title="'+m.title+'" points="';var g=s*(m.width/100),d=n*(m.height/100);m.vs=new Array;for(i=0;i<m.points.length;i++){var u=s*(m.x/100)+m.points[i].x/100*g,c=n*(m.y/100)+m.points[i].y/100*d;a+=u+","+c+" ",m.vs.push([u,c])}a+='"></polygon>'}"path"===m.type&&(g=s*(m.width/100),d=n*(m.height/100),a+='<path class="imp-shape '+l+' imp-shape-poly" data-index='+t+' id="'+m.id+'" data-shape-title="'+m.title+'" d="'+m.d+'"></path>')}a+="</svg>";for(var m,f,y="",t=0;t<this.settings.spots.length;t++)isTrue(this.settings.layers.enable_layers)&&parseInt(this.settings.spots[t].layerID,10)!==parseInt(this.settings.runtime.layerID)||(f="",f=(f=(f=(f+="left: "+((m=this.settings.spots[t]).x_image_background+m.default_style.background_image_offset_x)+"%;")+"top: "+(m.y_image_background+m.default_style.background_image_offset_y)+"%;")+"width: "+m.width_image_background+"%;")+"height: "+m.height_image_background+"%;",y+='<div class="imp-shape-background-image" style="'+(f="image"===m.default_style.background_type&&m.default_style.background_image_url?(f+="opacity: "+m.default_style.background_image_opacity+";")+"transform: scale("+m.default_style.background_image_scale+");":f)+'" data-id="'+m.id+'"></div>');this.shapeContainer.html(e+a),this.imageBackgroundsContainer.html(y)},generateShapeStyleClasses:function(){$("style#"+this.settings.id).remove();for(var t=document.createElement("style"),i=($(t).attr("id",this.settings.id),""),e=0;e<this.settings.spots.length;e++){var s=this.settings.spots[e],i=(i+="#"+s.id+" {")+this.calcStyles(s.default_style,e)+"}";"spot"===s.type&&0<$("#"+s.id).find("path").length&&(i=(i+="#"+s.id+" path {")+"fill: "+s.default_style.icon_fill+"}"),"image"===s.default_style.background_type&&(i=(i=(i=(i+="#imp-image-backgrounds-container-"+this.settings.id+' [data-id="'+s.id+'"] {')+"background-image: url("+s.default_style.background_image_url+");")+"opacity:"+s.default_style.background_image_opacity+";")+"transform: scale("+s.default_style.background_image_scale+") translate("+s.default_style.background_image_offset_x+"px, "+s.default_style.background_image_offset_y+"px);}"),i=(i+=".imp-shape-highlighted#"+s.id+" {")+this.calcStyles(s.mouseover_style,e)+"}","spot"===s.type&&0<$("#"+s.id).find("path").length&&(i=(i+=".imp-shape-highlighted#"+s.id+" path {")+"fill: "+s.mouseover_style.icon_fill+"}")}t.innerHTML=i,document.body.appendChild(t)},drawShapesMenu:function(){if(isTrue(this.settings.shapes_menu.enable_shapes_menu)){this.shapesMenuWrap&&this.shapesMenuWrap.remove(),this.shapesMenuResponsiveButton&&this.shapesMenuResponsiveButton.remove(),0<$(".imp-ui-layers-menu-wrap").length&&$(".imp-ui-layers-menu-wrap").css({right:20});var t="",i="imp-shapes-menu-wrap-left",e="",i=(t+='<div class="imp-shapes-menu-wrap '+(i="right"===this.settings.shapes_menu.menu_position?"imp-shapes-menu-wrap-right":i)+" "+(e=isTrue(this.settings.shapes_menu.enable_search)?"imp-shapes-menu-wrap-with-search-box":e)+'">',"");if(this.responsiveShapesMenu&&(i='<div data-imp-id="'+this.settings.id+'" class="imp-close-responsive-menu"><i class="fa fa-times" aria-hidden="true"></i></div>'),isTrue(this.settings.shapes_menu.enable_search)&&(t=(t=(t=(t+='<div class="imp-shapes-menu-search-box">   <div class="imp-shapes-menu-search-box-input-wrap">')+'       <input type="text" placeholder="Search..." data-image-map-pro-search-id="'+this.settings.id+'">       <i class="fa fa-search" aria-hidden="true"></i>')+'       <i class="fa fa-times imp-clear-search" aria-hidden="true" data-image-map-pro-id="'+this.settings.id+'"></i>   </div>')+i+"</div>"),t+='   <div class="imp-shapes-menu-scroll-wrap">',isTrue(this.settings.shapes_menu.group_by_floor)&&isTrue(this.settings.layers.enable_layers))for(var s=0;s<this.settings.layers.layers_list.length;s++){var n=this.settings.layers.layers_list[s];t+='<div class="imp-shapes-menu-layer-title" data-imp-content="'+n.title+'">'+n.title+"</div>";for(var a=0;a<this.settings.spots.length;a++){var o=this.settings.spots[a];isTrue(this.settings.shapes_menu.hide_children_of_connected_shapes)&&""!=o.connected_to||parseInt(o.layerID,10)===parseInt(n.id,10)&&(t+='<div class="imp-shapes-menu-shape-title" data-imp-image-map-name="'+this.settings.general.name+'" data-imp-highlight-shape-on-mouseover="'+o.title+'" data-imp-focus-shape-on-click="'+o.title+'" data-imp-content="'+o.title+'">'+o.title+"</div>")}}else for(a=0;a<this.settings.spots.length;a++){o=this.settings.spots[this.settings.spots.length-a-1];isTrue(this.settings.shapes_menu.hide_children_of_connected_shapes)&&""!=o.connected_to||(t+='<div class="imp-shapes-menu-shape-title" data-imp-image-map-name="'+this.settings.general.name+'" data-imp-highlight-shape-on-mouseover="'+o.title+'" data-imp-focus-shape-on-click="'+o.title+'" data-imp-content="'+o.title+'">'+o.title+"</div>")}t=t+"   </div>"+"</div>",isTrue(this.settings.shapes_menu.detached_menu)?($('[data-imp-detached-menu="'+this.settings.id+'"]').html(t),this.shapesMenuWrap=$('[data-imp-detached-menu="'+this.settings.id+'"]').find(".imp-shapes-menu-wrap")):this.responsiveShapesMenu?(this.responsiveShapesMenuWrap||($("body").append('<div data-imp-id="'+this.settings.id+'" class="imp-responsive-menu"></div>'),this.responsiveShapesMenuWrap=$('.imp-responsive-menu[data-imp-id="'+this.settings.id+'"]')),this.responsiveShapesMenuWrap.append(t),this.shapesMenuWrap=this.responsiveShapesMenuWrap.find(".imp-shapes-menu-wrap"),e="",e+='<div data-imp-id="'+this.settings.id+'" class="imp-ui-element imp-shapes-menu-button">',this.ui.append(e=e+'<i class="fa fa-bars" aria-hidden="true"></i>'+"</div>"),this.shapesMenuResponsiveButton=this.ui.find(".imp-shapes-menu-button"),0<$(".imp-ui-layers-menu-wrap").length&&$(".imp-ui-layers-menu-wrap").css({right:70}),$("#imp-fullscreen-wrap").find(".imp-fullscreen-root-wrap").removeClass("imp-shapes-menu-left"),$("#imp-fullscreen-wrap").find(".imp-fullscreen-root-wrap").removeClass("imp-shapes-menu-right")):isTrue(this.settings.runtime.is_fullscreen)?($("#imp-fullscreen-wrap").find(".imp-shapes-menu-wrap").remove(),$("#imp-fullscreen-wrap").append(t),0===$("#imp-fullscreen-wrap").find(".imp-fullscreen-root-wrap").length&&this.root.wrap('<div class="imp-fullscreen-root-wrap"></div>'),this.shapesMenuWrap=$("#imp-fullscreen-wrap").find(".imp-shapes-menu-wrap"),"left"===this.settings.shapes_menu.menu_position?$("#imp-fullscreen-wrap").find(".imp-fullscreen-root-wrap").addClass("imp-shapes-menu-left"):$("#imp-fullscreen-wrap").find(".imp-fullscreen-root-wrap").addClass("imp-shapes-menu-right")):(0===this.root.find(".imp-shapes-menu-outer-wrap").length&&this.wrap.wrap('<div class="imp-shapes-menu-outer-wrap"></div>'),"left"===this.settings.shapes_menu.menu_position?this.root.find(".imp-shapes-menu-outer-wrap").prepend(t):this.root.find(".imp-shapes-menu-outer-wrap").append(t),this.shapesMenuWrap=this.root.find(".imp-shapes-menu-wrap")),this.shapesMenuWrap.find('input[data-image-map-pro-search-id="'+this.settings.id+'"]').val(this.settings.runtime.menu_search_string),this.updateMenuSearch(),this.shapesMenuWrap.find(".imp-shapes-menu-scroll-wrap").scrollTop(this.settings.runtime.menu_scroll)}},addTooltips:function(){if("always"===this.settings.tooltips.fullscreen_tooltips||"mobile-only"===this.settings.tooltips.fullscreen_tooltips&&isMobile()){this.fullscreenTooltipsContainer||($('.imp-fullscreen-tooltips-container[data-image-map-id="'+this.settings.id+'"]').remove(),$("body").prepend('<div class="imp-fullscreen-tooltips-container" data-image-map-id="'+this.settings.id+'"></div>'),this.fullscreenTooltipsContainer=$('.imp-fullscreen-tooltips-container[data-image-map-id="'+this.settings.id+'"]'));for(var t="",i=0;i<this.settings.spots.length;i++)"text"!==(e=this.settings.spots[i]).type&&(n="",s=hexToRgb(e.tooltip_style.background_color)||{r:0,b:0,g:0},n=(n+="padding: "+e.tooltip_style.padding+"px;")+"background: rgba("+s.r+", "+s.g+", "+s.b+", "+e.tooltip_style.background_opacity+");","none"===this.settings.tooltips.tooltip_animation&&(n+="opacity: 0;"),"fade"===this.settings.tooltips.tooltip_animation&&(n+="opacity: 0;transition-property: opacity;-moz-transition-property: opacity;-webkit-transition-property: opacity;"),"grow"===this.settings.tooltips.tooltip_animation&&(n+="transform: scale(0, 0);-moz-transform: scale(0, 0);-webkit-transform: scale(0, 0);transition-property: transform;-moz-transition-property: -moz-transform;-webkit-transition-property: -webkit-transform;transform-origin: 50% 50%;-moz-transform-origin: 50% 50%;-webkit-transform-origin: 50% 50%;"),t=t+'<div class="imp-fullscreen-tooltip" style="'+n+'" data-index="'+i+'">   <div class="imp-tooltip-close-button" data-index="'+i+'"><i class="fa fa-times" aria-hidden="true"></i></div>',"plain-text"===e.tooltip_content.content_type?(n="",t+='<div class="imp-tooltip-plain-text" style="'+(n+="color: "+e.tooltip_content.plain_text_color+";")+'">'+e.tooltip_content.plain_text+"</div>"):e.tooltip_content.squares_json?t+=$.squaresRendererRenderObject(e.tooltip_content.squares_json):t+=$.squaresRendererRenderObject(e.tooltip_content.squares_settings),t+="</div>");this.fullscreenTooltipsContainer.html(t)}else{for(var e,s,n,a,t="",i=0;i<this.settings.spots.length;i++)"text"!==(e=this.settings.spots[i]).type&&(n="",s=hexToRgb(e.tooltip_style.background_color)||{r:0,b:0,g:0},n=(n=(n+="border-radius: "+e.tooltip_style.border_radius+"px;")+"padding: "+e.tooltip_style.padding+"px;")+"background: rgba("+s.r+", "+s.g+", "+s.b+", "+e.tooltip_style.background_opacity+");","none"===this.settings.tooltips.tooltip_animation&&(n+="opacity: 0;transition-property: transform; -moz-transition-property: -moz-transform; -webkit-transition-property: -webkit-transform;"),"fade"===this.settings.tooltips.tooltip_animation&&(n+="opacity: 0;transition-property: transform, opacity; -moz-transition-property: -moz-transform, opacity;-webkit-transition-property: -webkit-transform, opacity;"),"grow"===this.settings.tooltips.tooltip_animation&&(n+="transform: scale(0, 0);-moz-transform: scale(0, 0);-webkit-transform: scale(0, 0);transition-property: transform; -moz-transition-property: -moz-transform; -webkit-transition-property: -webkit-transform;","top"===e.tooltip_style.position&&(n+="transform-origin: 50% 100%;-moz-transform-origin: 50% 100%;-webkit-transform-origin: 50% 100%;"),"bottom"===e.tooltip_style.position&&(n+="transform-origin: 50% 0%;-moz-transform-origin: 50% 0%;-webkit-transform-origin: 50% 0%;"),"left"===e.tooltip_style.position&&(n+="transform-origin: 100% 50%;-moz-transform-origin: 100% 50%;-webkit-transform-origin: 100% 50%;"),"right"===e.tooltip_style.position&&(n+="transform-origin: 0% 50%;-moz-transform-origin: 0% 50%;-webkit-transform-origin: 0% 50%;")),t+='<div class="imp-tooltip" style="'+n+'" data-index="'+i+'">',"top"===e.tooltip_style.position&&(t+='   <div class="hs-arrow hs-arrow-bottom" style="border-top-color: rgba('+s.r+", "+s.g+", "+s.b+", "+e.tooltip_style.background_opacity+');"></div>'),"bottom"===e.tooltip_style.position&&(t+='   <div class="hs-arrow hs-arrow-top" style="border-bottom-color: rgba('+s.r+", "+s.g+", "+s.b+", "+e.tooltip_style.background_opacity+');"></div>'),"left"===e.tooltip_style.position&&(t+='   <div class="hs-arrow hs-arrow-right" style="border-left-color: rgba('+s.r+", "+s.g+", "+s.b+", "+e.tooltip_style.background_opacity+');"></div>'),"right"===e.tooltip_style.position&&(t+='   <div class="hs-arrow hs-arrow-left" style="border-right-color: rgba('+s.r+", "+s.g+", "+s.b+", "+e.tooltip_style.background_opacity+');"></div>'),n="",n+="color: "+e.tooltip_content.plain_text_color+";",a={containers:[{id:"sq-container-403761",settings:{elements:[{settings:{name:"Paragraph",iconClass:"fa fa-paragraph"},options:{text:{text:e.title}}}]}}]},t+='<div class="imp-tooltip-title" style="'+n+'">'+$.squaresRendererRenderObject(a)+"</div>","plain-text"===e.tooltip_content.content_type?t+='<div class="imp-tooltip-plain-text" style="'+n+'">'+e.tooltip_content.plain_text+"</div>":e.tooltip_content.squares_json?t+=$.squaresRendererRenderObject(e.tooltip_content.squares_json):t+=$.squaresRendererRenderObject(e.tooltip_content.squares_settings),t+="</div>");this.tooltipsContainer.prepend(t),isTrue(this.settings.tooltips.sticky_tooltips)&&this.tooltipsContainer.addClass("imp-sticky-tooltips")}},initFullscreen:function(){var t,i,e,s;isTrue(this.settings.fullscreen.enable_fullscreen_mode)&&(s="",s=(s+="background: "+this.settings.fullscreen.fullscreen_button_color+"; ")+"color: "+this.settings.fullscreen.fullscreen_button_text_color+"; ",i='<i class="fa fa-arrows-alt" aria-hidden="true"></i>',isTrue(this.settings.runtime.is_fullscreen)&&(i='<i class="fa fa-times" aria-hidden="true"></i>'),e="Go Fullscreen",isTrue(this.settings.runtime.is_fullscreen)&&(e="Close Fullscreen"),t="","icon"===this.settings.fullscreen.fullscreen_button_type&&(t+=i),"text"===this.settings.fullscreen.fullscreen_button_type&&(t+=e),"icon_and_text"===this.settings.fullscreen.fullscreen_button_type&&(t+=i+" "+e),i="","icon"===this.settings.fullscreen.fullscreen_button_type&&(i+="imp-fullscreen-button-icon-only"),e="",e+='<div data-imp-id="'+this.settings.id+'" style="'+s+'" class="imp-ui-element '+i+" imp-fullscreen-button imp-fullscreen-button-position-"+this.settings.fullscreen.fullscreen_button_position+'">',this.ui.append(e=e+t+"</div>"),isTrue(this.settings.runtime.is_fullscreen)&&($(window).scrollTop(0),fullscreenMap=this),s=this.ui.find(".imp-fullscreen-button"),1!==parseInt(this.settings.fullscreen.fullscreen_button_position,10)&&4!==parseInt(this.settings.fullscreen.fullscreen_button_position,10)||s.css({"margin-left":-s.outerWidth()/2}),isTrue(this.settings.fullscreen.start_in_fullscreen_mode)&&0===this.settings.runtime.is_fullscreen&&(this.settings.fullscreen.start_in_fullscreen_mode=0,this.toggleFullscreen()))},initNavigator:function(){isTrue(this.settings.zooming.enable_zooming)&&isTrue(this.settings.zooming.enable_navigator)&&(this.uiNavigatorRoot=this.ui.find(".imp-ui-navigator-root"),this.uiNavigatorImage=this.ui.find(".imp-ui-navigator-window-image"),this.adjustNavigatorSize())},initLayers:function(){if(isTrue(this.settings.layers.enable_layers)){for(var t=!1,i=0;i<this.settings.layers.layers_list.length;i++)parseInt(this.settings.layers.layers_list[i].id,10)===parseInt(this.settings.runtime.layerID,10)&&(t=!0);t||(this.settings.runtime.layerID=this.settings.layers.layers_list[0].id),this.wrap.find(".imp-ui-layers-select").val(this.settings.runtime.layerID)}},initZoom:function(){isTrue(this.settings.zooming.enable_zooming)&&(this.zoom=1,this.targetZoom=1,this.targetPanX=0,this.actualPanX=0,this.targetPanY=0,this.actualPanY=0,this.initialPanX=0,this.initialPanY=0,this.panDeltaY=0,isTrue(this.settings.zooming.limit_max_zoom_to_image_size)?this.maxZoomLevel=this.settings.general.naturalWidth/this.wrap.width():this.maxZoomLevel=this.settings.zooming.max_zoom)},adjustNavigatorSize:function(){var t,i,e,s;isTrue(this.settings.zooming.enable_zooming)&&isTrue(this.settings.zooming.enable_navigator)&&(isTrue(this.settings.runtime.is_fullscreen)?(this.navigatorRatio=this.uiNavigatorRoot.width()/this.settings.general.width,s=e=0,(t=this.settings.general.naturalWidth/this.settings.general.naturalHeight)<(i=window.innerWidth/window.innerHeight)?(t<1?(e=150*t,this.uiNavigatorWindowWidth=(s=150)*i):this.uiNavigatorWindowWidth=(s=(e=150)/t)*i,this.uiNavigatorWindowHeight=s,this.navigatorMarginX=e/2-this.uiNavigatorWindowWidth/2,this.navigatorMarginY=0):(t<1?this.uiNavigatorWindowWidth=e=(s=150)*t:(s=(e=150)/t,this.uiNavigatorWindowWidth=e),this.uiNavigatorWindowHeight=e/i,this.navigatorMarginX=0,this.navigatorMarginY=s/2-this.uiNavigatorWindowHeight/2)):(this.navigatorRatio=this.uiNavigatorRoot.width()/this.wrap.width(),this.uiNavigatorWindowWidth=this.uiNavigatorRoot.width(),this.uiNavigatorWindowHeight=this.uiNavigatorRoot.height()))},measureTooltipSize:function(t){var i;"always"===this.settings.tooltips.fullscreen_tooltips||"mobile-only"===this.settings.tooltips.fullscreen_tooltips&&isMobile()||(i=this.settings.spots[t],t=this.tooltipsContainer.find('.imp-tooltip[data-index="'+t+'"]'),isTrue(i.tooltip_style.auto_width)||t.css({width:i.tooltip_style.width}),t[0].getBoundingClientRect(),t.data("imp-measured-width",t.outerWidth()),t.data("imp-measured-height",t.outerHeight()))},animateShapesLoop:function(){if("none"!==this.settings.shapes.pageload_animation){this.didAnimateShapesOnPageload=!0;for(var t=750/this.settings.spots.length,i=shuffle(this.settings.spots.slice()),e=0;e<i.length;e++)this.animateShape(i[e],t*e)}},animateShape:function(t,i){var e=this,s=this.root.find("#"+t.id),n=0;setTimeout(function(){"fade"===e.settings.shapes.pageload_animation&&s.css({opacity:t.default_style.opacity}),"grow"===e.settings.shapes.pageload_animation&&s.css({transform:"scale(1, 1)","-moz-transform":"scale(1, 1)","-webkit-transform":"scale(1, 1)"}),"fall-down"===e.settings.shapes.pageload_animation&&(s.css({opacity:t.default_style.opacity}),"spot"===t.type&&(s.css({"transition-property":"opacity"}),function i(){requestAnimationFrame(function(){var t=easeOutBounce(undefined,n+=.01666,-200,200,1);s.css({transform:"translateY("+t+"px)"}),n<=1&&i()})}()))},i)},events:function(){var s=this;$(document).off("mousedown."+this.settings.id),$(document).on("mousedown."+this.settings.id,function(t){touch||s.handleEventStart(t)}),$(document).off("mousemove."+this.settings.id),$(document).on("mousemove."+this.settings.id,function(t){touch||s.handleEventMove(t)}),$(document).off("mouseup."+this.settings.id),$(document).on("mouseup."+this.settings.id,function(t){touch||s.handleEventEnd(t)}),$(document).off("touchstart."+this.settings.id),$(document).on("touchstart."+this.settings.id,function(t){s.handleEventStart(t)}),$(document).off("touchmove."+this.settings.id),$(document).on("touchmove."+this.settings.id,function(t){return s.handleEventMove(t),(!s.panning||0==s.panDeltaY)&&(!s.pinching&&void 0)}),$(document).off("touchend."+this.settings.id),$(document).on("touchend."+this.settings.id,function(t){s.handleEventEnd(t)}),this.wrap.off("mousewheel"),this.wrap.on("mousewheel",function(t){if(!touch)return isTrue(s.settings.zooming.enable_zooming)?isTrue(s.settings.zooming.hold_ctrl_to_zoom)?s.mac&&s.cmdKeyDown||!s.mac&&s.ctrlKeyDown?(s.handleEventEnd(t),!1):(s.displayScrollMessage(),!0):(s.handleEventEnd(t),!(t.deltaY<0&&1<s.targetZoom||0<t.deltaY&&s.targetZoom<s.maxZoomLevel)&&void 0):void 0}),$(document).off("keydown."+this.settings.id),$(document).on("keydown."+this.settings.id,function(t){s.handleKeyDownEvent(t)}),$(document).off("keyup."+this.settings.id),$(document).on("keyup."+this.settings.id,function(t){s.handleKeyUpEvent(t)}),$(document).off("click."+this.settings.id,".imp-tooltip-close-button"),$(document).on("click."+this.settings.id,".imp-tooltip-close-button",function(){s.hideAllTooltips()}),$(document).off("change."+this.settings.id,".imp-ui-layers-select"),$(document).on("change."+this.settings.id,".imp-ui-layers-select",function(){var t=s.wrap.find(".imp-ui-layers-select").val();s.switchLayer(t)}),$(document).off("keyup."+this.settings.id,'[data-image-map-pro-search-id="'+this.settings.id+'"]'),$(document).on("keyup."+this.settings.id,'[data-image-map-pro-search-id="'+this.settings.id+'"]',function(t){s.updateMenuSearch()}),$(document).off("change."+this.settings.id,'[data-image-map-pro-search-id="'+this.settings.id+'"]'),$(document).on("change."+this.settings.id,'[data-image-map-pro-search-id="'+this.settings.id+'"]',function(t){s.updateMenuSearch()}),$(window).off("resize."+this.settings.general.id+this.settings.runtime.is_fullscreen),$(window).on("resize."+this.settings.general.id+this.settings.runtime.is_fullscreen,function(){if(s.wrapWidth=s.wrap.width(),s.wrapHeight=s.wrap.height(),s.wrapOffsetLeft=s.wrap.offset().left,s.wrapOffsetTop=s.wrap.offset().top,0<s.openedTooltips.length)for(var t=0;t<s.openedTooltips.length;t++)s.updateTooltipPosition(s.openedTooltips[t]);var i,e;s.resetZoomAndPan(),s.adjustNavigatorSize(),isTrue(s.settings.shapes_menu.enable_shapes_menu)&&(i=s.responsiveShapesMenu,e=s.root.width(),s.settings.runtime.is_fullscreen&&(e=$(window).width()),isMobile()||e/3<240?s.responsiveShapesMenu=!0:s.responsiveShapesMenu=!1,i!=s.responsiveShapesMenu&&s.drawShapesMenu(),!isTrue(s.settings.shapes_menu.enable_shapes_menu)||isTrue(s.settings.shapes_menu.detached_menu)||s.settings.runtime.is_fullscreen||s.responsiveShapesMenu||(isTrue(s.settings.shapes_menu.enable_search)?s.shapesMenuWrap.height(s.wrap.height()-73):s.shapesMenuWrap.height(s.wrap.height()))),fullscreenMap&&fullscreenMap.adjustSize(),""===s.settings.image.url&&(isTrue(s.settings.general.responsive)?(s.wrap.css({width:"100%",height:s.settings.general.height,"max-width":s.settings.general.width,"max-height":s.settings.general.height}),s.wrap.css({height:s.wrap.width()*(s.settings.general.height/s.settings.general.width)})):s.wrap.css({width:s.settings.general.width,height:s.settings.general.height}))})},disableEvents:function(){$(document).off("mousedown."+this.settings.id),$(document).off("mousemove."+this.settings.id),$(document).off("mouseup."+this.settings.id),$(document).off("touchstart."+this.settings.id),$(document).off("touchmove."+this.settings.id),$(document).off("touchend."+this.settings.id),this.wrap.off("mousewheel"),$(document).off("keydown."+this.settings.id),$(document).off("keyup."+this.settings.id),$(document).off("click."+this.settings.id,".imp-tooltip-close-button"),$(document).off("change."+this.settings.id,".imp-ui-layers-select"),$(document).off("keyup."+this.settings.id,'[data-image-map-pro-search-id="'+this.settings.id+'"]'),$(document).off("change."+this.settings.id,'[data-image-map-pro-search-id="'+this.settings.id+'"]'),$(window).off("resize."+this.settings.general.id+this.settings.runtime.is_fullscreen)},isEventOnHTMLAPIElement:function(t){return!!$(t.target).data("imp-highlight-shape-on-mouseover")||(!!$(t.target).data("imp-highlight-shape-on-click")||(!!$(t.target).data("imp-unhighlight-shape-on-mouseover")||(!!$(t.target).data("imp-unhighlight-shape-on-click")||(!!$(t.target).data("imp-open-tooltip-on-mouseover")||(!!$(t.target).data("imp-open-tooltip-on-click")||(!!$(t.target).data("imp-close-tooltip-on-mouseover")||(!!$(t.target).data("imp-close-tooltip-on-click")||(!!$(t.target).data("imp-trigger-shape-on-mouseover")||(!!$(t.target).data("imp-trigger-shape-on-click")||(!!$(t.target).data("imp-untrigger-shape-on-mouseover")||(!!$(t.target).data("imp-untrigger-shape-on-click")||(!!$(t.target).data("imp-focus-shape-on-click")||!!$(t.target).data("imp-focus-shape-on-mouseover")))))))))))))},handleEventStart:function(t){this.targetZoom=this.zoom,this.targetPanX=this.actualPanX,this.targetPanY=this.actualPanY;var i=this.getEventCoordinates(t);if(!this.isEventOnHTMLAPIElement(t))return isTrue(this.settings.zooming.enable_zooming)?0<$(t.target).closest(".imp-ui-navigator-root").length&&$(t.target).closest(".imp-ui-navigator-root").data("imp-id")===parseInt(this.settings.id)?(this.ix=i.x,this.iy=i.y,void(this.panningOnNavigator=!0)):t.originalEvent.touches&&1<t.originalEvent.touches.length?(this.pinchInitial[0]={x:t.originalEvent.touches[0].pageX,y:t.originalEvent.touches[0].pageY},this.pinchInitial[1]={x:t.originalEvent.touches[1].pageX,y:t.originalEvent.touches[1].pageY},this.initialPanX=this.actualPanX,this.initialPanY=this.actualPanY,this.ix=(t.originalEvent.touches[0].pageX+t.originalEvent.touches[1].pageX)/2,this.iy=(t.originalEvent.touches[0].pageY+t.originalEvent.touches[1].pageY)/2,this.lastX=this.ix,this.lastY=this.iy,this.pinchInitialDistance=Math.sqrt(Math.pow(this.pinchInitial[1].x-this.pinchInitial[0].x,2)+Math.pow(this.pinchInitial[1].y-this.pinchInitial[0].y,2)),this.pinchInitialZoom=this.zoom,void(this.pinching=!0)):void(!this.panning&&0===$(t.target).closest(".imp-ui").length&&(i.x>this.wrapOffsetLeft&&i.x<this.wrapOffsetLeft+this.wrapWidth&&i.y>this.wrapOffsetTop&&i.y<this.wrapOffsetTop+this.wrapHeight||t.target.closest(".imp-fullscreen-root-wrap"))&&(this.ix=i.x,this.iy=i.y,this.initialPanX=this.actualPanX,this.initialPanY=this.actualPanY,this.panning=!0)):void 0},handleEventMove:function(t){if(1e3<Date.now()-this.lastWrapRecalc&&(this.lastWrapRecalc=Date.now(),this.wrapWidth=this.wrap.width(),this.wrapHeight=this.wrap.height(),this.wrapOffsetLeft=this.wrap.offset().left,this.wrapOffsetTop=this.wrap.offset().top),!this.fullscreenTooltipVisible){var i=parseInt(this.matchShapeToEvent(t)),e=this.getEventCoordinates(t),s=!1;if(this.isPointInsideVisibleTooltip(t)&&!isTrue(this.settings.tooltips.sticky_tooltips))s=!0;else{var n,a,o=!1;if((e.x<this.wrapOffsetLeft||e.x>this.wrapOffsetLeft+this.wrapWidth||e.y<this.wrapOffsetTop||e.y>this.wrapOffsetTop+this.wrapHeight)&&(o=!0),isTrue(this.settings.zooming.enable_zooming)){if(this.panningOnNavigator)return n=(e.x-this.uiNavigatorRoot.offset().left)/this.navigatorRatio*this.targetZoom,a=(e.y-this.uiNavigatorRoot.offset().top)/this.navigatorRatio*this.targetZoom,void this.panTo(n,a);if(this.pinching)return this.pinch(t),void(this.didPan=!0);if(this.panning)return e=this.getEventCoordinates(t),this.pan(e.x,e.y),void(this.didPan=!0)}if(!s&&o)this.hideAllTooltips();else{if(1===$(t.target).closest(".imp-ui").length)return this.unhighlightAllShapes(),void("mouseover"===this.settings.tooltips.show_tooltips&&this.hideAllTooltips());-1!==i&&(isTrue(this.settings.shapes.glowing_shapes)&&isTrue(this.settings.shapes.stop_glowing_on_mouseover)&&this.wrap.addClass("imp-no-glow"),this.didPan||(this.isShapeHighlighted(i)||(this.unhighlightAllShapes(),"mouseover"===this.settings.tooltips.show_tooltips&&this.hideAllTooltips(),isTrue(this.settings.tooltips.show_title_on_mouseover)&&"click"===this.settings.tooltips.show_tooltips&&this.hideAllTitles(),this.highlightShape(i,!0)),isTrue(this.settings.tooltips.enable_tooltips)&&("mouseover"===this.settings.tooltips.show_tooltips&&isTrue(this.settings.spots[i].tooltip.enable_tooltip)&&this.showTooltip(i),"click"===this.settings.tooltips.show_tooltips&&isTrue(this.settings.tooltips.show_title_on_mouseover)&&isTrue(this.settings.spots[i].tooltip.enable_tooltip)&&this.showTooltipTitle(i),0<this.openedTooltips.length&&isTrue(this.settings.tooltips.sticky_tooltips)&&"mouseover"===this.settings.tooltips.show_tooltips&&this.updateTooltipPosition(this.openedTooltips[this.openedTooltips.length-1],t),isTrue(this.settings.tooltips.show_title_on_mouseover)&&"click"===this.settings.tooltips.show_tooltips&&-1===this.openedTooltips.indexOf(i)&&this.updateTooltipPosition(i,t)))),$(t.target).is("video")||0<$(t.target).closest("video").length||-1===i&&(this.unhighlightAllShapes(),isTrue(this.settings.tooltips.show_title_on_mouseover)&&"click"===this.settings.tooltips.show_tooltips&&this.hideAllTitles(),"mouseover"===this.settings.tooltips.show_tooltips&&0<this.openedTooltips.length&&this.hideAllTooltips())}}}},handleEventEnd:function(t){if(!this.isEventOnHTMLAPIElement(t)){if(isTrue(this.settings.zooming.enable_zooming)){if(this.panning&&(this.panning=!1,this.tooltipsContainer.removeClass("imp-no-transition")),this.pinching&&(this.pinching=!1),"mousewheel"===t.type)return this.hideAllTooltips(),this.unhighlightAllShapes(),0<t.deltaY&&this.zoomIn(t),void(t.deltaY<0&&this.zoomOut(t));var i,e;if(this.panningOnNavigator&&0<$(t.target).closest(".imp-ui-navigator-root").length&&parseInt($(t.target).closest(".imp-ui-navigator-root").data("imp-id"))===parseInt(this.settings.id))return this.panningOnNavigator=!1,i=((a=this.getEventCoordinates(t)).x-this.uiNavigatorRoot.offset().left)/this.navigatorRatio*this.targetZoom,e=(a.y-this.uiNavigatorRoot.offset().top)/this.navigatorRatio*this.targetZoom,void this.panTo(i,e);if(this.panningOnNavigator&&(this.panningOnNavigator=!1),0<$(t.target).closest(".imp-ui-zoom-button").length&&parseInt($(t.target).closest(".imp-ui-zoom-button").data("imp-id"))===parseInt(this.settings.id))return void(0<$(t.target).closest(".imp-ui-zoom-button-zoom-in").length?this.zoomIn():this.zoomOut())}if(0<$(t.target).closest(".imp-fullscreen-button").length&&parseInt($(t.target).closest(".imp-fullscreen-button").data("imp-id"))===parseInt(this.settings.id))return this.toggleFullscreen(),t.preventDefault(),!1;if(0<$(t.target).closest(".imp-shapes-menu-button").length&&parseInt($(t.target).closest(".imp-shapes-menu-button").data("imp-id"))===parseInt(this.settings.id)&&this.showResponsiveShapesMenu(),0<$(t.target).closest(".imp-close-responsive-menu").length&&parseInt($(t.target).closest(".imp-close-responsive-menu").data("imp-id"))===parseInt(this.settings.id)&&this.hideResponsiveShapesMenu(),0<$(t.target).closest(".imp-ui-layer-switch-up").length&&parseInt($(t.target).closest(".imp-ui-layer-switch-up").data("imp-id"))===parseInt(this.settings.id))for(var s=0;s<this.settings.layers.layers_list.length;s++)if(parseInt(this.settings.layers.layers_list[s].id,10)===parseInt(this.settings.runtime.layerID,10)&&0<s){var n=this.settings.layers.layers_list[s-1].id;this.switchLayer(n);break}if(0<$(t.target).closest(".imp-ui-layer-switch-down").length&&parseInt($(t.target).closest(".imp-ui-layer-switch-down").data("imp-id"))===parseInt(this.settings.id))for(s=0;s<this.settings.layers.layers_list.length;s++)if(parseInt(this.settings.layers.layers_list[s].id,10)===parseInt(this.settings.runtime.layerID,10)&&s<this.settings.layers.layers_list.length-1){n=this.settings.layers.layers_list[s+1].id;this.switchLayer(n);break}if($(t.target).hasClass("imp-clear-search")&&$(t.target).data("image-map-pro-id")===parseInt(this.settings.id)&&($('input[data-image-map-pro-search-id="'+this.settings.id+'"]').val(""),this.updateMenuSearch()),0==$(t.target).closest(".imp-tooltip").length&&!this.fullscreenTooltipVisible){if(1===$(t.target).closest(".imp-ui").length)return this.unhighlightAllShapes(),void("mouseover"===this.settings.tooltips.show_tooltips&&this.hideAllTooltips());this.getEventRelativeCoordinates(t);var s=this.matchShapeToEvent(t),a=this.getEventCoordinates(t);-1!=s&&(a.x>this.wrapOffsetLeft&&a.x<this.wrapOffsetLeft+this.wrapWidth&&a.y>this.wrapOffsetTop&&a.y<this.wrapOffsetTop+this.wrapHeight||this.settings.runtime.is_fullscreen)&&(this.didPan||(this.isShapeHighlighted(s)||(this.unhighlightAllShapes(),"mouseover"===this.settings.tooltips.show_tooltips&&this.hideAllTooltips(),this.highlightShape(s,!0)),isTrue(this.settings.tooltips.enable_tooltips)&&isTrue(this.settings.spots[s].tooltip.enable_tooltip)&&this.showTooltip(s),0<this.openedTooltips.length&&isTrue(this.settings.tooltips.sticky_tooltips)&&"mouseover"===this.settings.tooltips.show_tooltips&&this.updateTooltipPosition(this.openedTooltips[this.openedTooltips.length-1],t),isTrue(this.settings.zooming.enable_zooming)&&isTrue(this.settings.zooming.focus_shape_on_click)&&this.focusShape(s)),this.performClickAction(s)),(-1===s||(a.x<this.wrapOffsetLeft||a.x>this.wrapOffsetLeft+this.wrapWidth||a.y<this.wrapOffsetTop||a.y>this.wrapOffsetTop+this.wrapHeight)&&!this.settings.runtime.is_fullscreen)&&(this.hideAllTooltips(),this.didPan||this.unhighlightAllShapes()),t.originalEvent.touches&&0===t.originalEvent.touches.length&&(this.didPan=!1),t.originalEvent.touches||(this.didPan=!1)}}},handleKeyDownEvent:function(t){t.ctrlKey&&(this.ctrlKeyDown=!0),t.metaKey&&(this.cmdKeyDown=!0)},handleKeyUpEvent:function(t){this.ctrlKeyDown=!1,this.cmdKeyDown=!1},getEventRelativeCoordinates:function(t){var i,e;return"touchstart"===t.type||"touchmove"===t.type||"touchend"===t.type||"touchcancel"===t.type?(i=(e=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0]).pageX,e=e.pageY):"mousedown"!==t.type&&"mouseup"!==t.type&&"mousemove"!==t.type&&"mouseover"!==t.type&&"mouseout"!==t.type&&"mouseenter"!==t.type&&"mouseleave"!==t.type||(i=t.pageX,e=t.pageY),i-=this.zoomWrap.offset().left,e-=this.zoomWrap.offset().top,{x:i=i/(this.wrap.width()*this.zoom)*100,y:e=e/(this.wrap.height()*this.zoom)*100}},getEventCoordinates:function(t){var i,e;return"touchstart"===t.type||"touchmove"===t.type||"touchend"===t.type||"touchcancel"===t.type?(i=(e=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0]).pageX,e=e.pageY):"mousedown"!==t.type&&"mouseup"!==t.type&&"mousemove"!==t.type&&"mouseover"!==t.type&&"mouseout"!==t.type&&"mouseenter"!==t.type&&"mouseleave"!==t.type||(i=t.pageX,e=t.pageY),{x:i,y:e}},matchShapeToCoords:function(t){for(var i=this.settings.spots.length-1;0<=i;i--)if(!isTrue(this.settings.layers.enable_layers)||parseInt(this.settings.spots[i].layerID,10)===parseInt(this.settings.runtime.layerID,10)){var e=this.settings.spots[i];if(!isTrue(e.static)){if("poly"===e.type||"path"===e.type){var s=t.x/100*this.zoomWrap.width(),n=t.y/100*this.zoomWrap.height();if(isPointInsidePolygon(s=s*this.settings.general.naturalWidth/this.zoomWrap.width(),n=n*this.settings.general.naturalHeight/this.zoomWrap.height(),e.vs))return i}if("spot"===e.type){var a=e.width<44?44:e.width,o=e.height<44?44:e.height,s=(a/=this.zoom,o/=this.zoom,t.x/100*this.wrap.width()),n=t.y/100*this.wrap.height(),h=e.x/100*this.wrap.width()-a/2,r=e.y/100*this.wrap.height()-o/2,p=o;if(isTrue(e.default_style.icon_is_pin)&&isTrue(e.default_style.use_icon)&&(r-=o/2,e.height<44&&(r+=e.height/2)),isPointInsideRect(s,n,h,r,a,p))return i}if("rect"===e.type&&isPointInsideRect(t.x,t.y,e.x,e.y,e.width,e.height))return i;if("oval"===e.type)if(isPointInsideEllipse(s=t.x,n=t.y,e.x+e.width/2,e.y+e.height/2,h=e.width/2,r=e.height/2))return i;e.type}}return-1},matchShapeToEvent:function(t){return $(t.target).hasClass("imp-shape")||0<$(t.target).closest(".imp-shape").length?$(t.target).data("index")||$(t.target).closest(".imp-shape").data("index"):-1},isPointInsideVisibleTooltip:function(t){for(var i=0;i<this.openedTooltips.length;i++){var e=this.getEventCoordinates(t),s=this.tooltipsContainer.find('.imp-tooltip[data-index="'+this.openedTooltips[i]+'"]'),n=this.openedTooltips[i],a=(e.x=(e.x-this.wrap.offset().left)/this.wrap.width()*100,e.y=(e.y-this.wrap.offset().top)/this.wrap.height()*100,0),o=(a="spot"===this.settings.spots[n].type?this.settings.spots[n].tooltip_style.buffer:this.settings.spots[n].tooltip_style.buffer*this.zoom,s.outerWidth()),h=s.outerHeight(),r=s.offset().left-this.wrap.offset().left,s=s.offset().top-this.wrap.offset().top,r=r/this.wrap.width()*100,s=s/this.wrap.height()*100,o=o/this.wrap.width()*100,h=h/this.wrap.height()*100,p=[];return"left"===this.settings.spots[n].tooltip_style.position&&(p=[[r,s],[r+o,s],[r+o+(a=a/this.wrap.width()*100),s+h-h/3-h/3],[r+o+a,s+h-h/3],[r+o,s+h],[r,s+h]]),"right"===this.settings.spots[n].tooltip_style.position&&(p=[[r,s],[r+o,s],[r+o,s+h],[r,s+h],[r-(a=a/this.wrap.width()*100),s+h-h/3],[r-a,s+h-h/3-h/3]]),"top"===this.settings.spots[n].tooltip_style.position&&(p=[[r,s],[r+o,s],[r+o,s+h],[r+o-o/3,s+h+(a=a/this.wrap.height()*100)],[r+o-o/3-o/3,s+h+a],[r,s+h]]),"bottom"===this.settings.spots[n].tooltip_style.position&&(p=[[r,s],[r+o-o/3-o/3,s-(a=a/this.wrap.height()*100)],[r+o-o/3,s-a],[r+o,s],[r+o,s+h],[r,s+h]]),isPointInsidePolygon(e.x,e.y,p)?!0:!1}},getIndexOfShapeWithID:function(t){for(var i=0;i<this.settings.spots.length;i++)if(this.settings.spots[i].id===t)return i},calcStyles:function(t,i){var e,s,n,a,o,i=this.settings.spots[i],h="";return"spot"===i.type&&(h=(h=(h=(h+="left: "+i.x+"%;")+"top: "+i.y+"%;")+"width: "+i.width+"px;")+"height: "+i.height+"px;",this.didAnimateShapesOnPageload||("fall-down"===this.settings.shapes.pageload_animation?h+="opacity: 0;transform: translateY(-500px);":h="grow"===this.settings.shapes.pageload_animation?h+("opacity: "+t.opacity)+";transform: scale(0);":"fade"===this.settings.shapes.pageload_animation?h+"opacity: 0;transform: scale("+1/this.zoom+");":(h+="opacity: "+t.opacity+";")+"transform: scale("+1/this.zoom+");"),a=-i.width/2,e=-i.height/2,isTrue(i.default_style.use_icon)||(s=hexToRgb(t.background_color)||{r:0,b:0,g:0},n=hexToRgb(t.border_color)||{r:0,b:0,g:0},h=(h=(h=(h=(h+="border-radius: "+t.border_radius+"px;")+"background: rgba("+s.r+", "+s.g+", "+s.b+", "+t.background_opacity+");")+"border-width: "+t.border_width+"px;")+"border-style: "+t.border_style+";")+"border-color: rgba("+n.r+", "+n.g+", "+n.b+", "+t.border_opacity+");"),isTrue(i.default_style.use_icon)&&(isTrue(i.default_style.icon_is_pin)&&(a=-i.height),"library"===i.default_style.icon_type&&(h+="color: rgba("+(o=hexToRgb(t.icon_fill)||{r:0,b:0,g:0}).r+", "+o.g+", "+o.b+", "+t.opacity+");")),h=h+"margin-left: "+e+"px;margin-top: "+a+"px;"),"text"===i.type&&(o=hexToRgb(i.text.text_color),h=(h=(h=(h=(h=(h+="left: "+i.x+"%;")+"top: "+i.y+"%;")+"font-family: "+i.text.font_family+";")+"font-size: "+i.text.font_size+"px;")+"font-weight: "+i.text.font_weight+";")+"color: rgba("+o.r+", "+o.g+", "+o.b+", "+i.text.text_opacity+");",this.didAnimateShapesOnPageload||(h="grow"===this.settings.shapes.pageload_animation?h+("opacity: "+t.opacity)+";transform: scale(0);":"fade"===this.settings.shapes.pageload_animation?h+"opacity: 0;transform: scale("+1/this.zoom+");":(h+="opacity: "+t.opacity+";")+"transform: scale("+1/this.zoom+");")),"rect"!==i.type&&"oval"!==i.type||(e=t.border_radius+"px","oval"===i.type&&(e="50% 50%"),s=hexToRgb(t.background_color)||{r:0,b:0,g:0},n=hexToRgb(t.border_color)||{r:0,b:0,g:0},h=(h=(h=(h+="left: "+i.x+"%;")+"top: "+i.y+"%;")+"width: "+i.width+"%;")+"height: "+i.height+"%;","color"===t.background_type&&(h+="background: rgba("+s.r+", "+s.g+", "+s.b+", "+t.background_opacity+");"),h=(h=(h+="border-width: "+t.border_width+"px;")+"border-style: "+t.border_style+";")+"border-color: rgba("+n.r+", "+n.g+", "+n.b+", "+t.border_opacity+");border-radius: "+e+";",this.didAnimateShapesOnPageload||("grow"===this.settings.shapes.pageload_animation?h=h+("opacity: "+t.opacity)+";transform: scale(0);":"fade"===this.settings.shapes.pageload_animation?h+="opacity: 0;transform: scale(1);":h=h+("opacity: "+t.opacity)+";transform: scale(1);")),"poly"!==i.type&&"path"!==i.type||(a=hexToRgb(t.background_color)||{r:0,b:0,g:0},o=hexToRgb(t.stroke_color)||{r:0,b:0,g:0},"color"===t.background_type?h+="fill: rgba("+a.r+", "+a.g+", "+a.b+", "+t.background_opacity+");":h+="fill: rgba(0, 0, 0, 0);",h=(h=(h=(h+="stroke: rgba("+o.r+", "+o.g+", "+o.b+", "+t.stroke_opacity+");")+"stroke-width: "+t.stroke_width+"px;")+"stroke-dasharray: "+t.stroke_dasharray+";")+"stroke-linecap: "+t.stroke_linecap+";",this.didAnimateShapesOnPageload||("fade"===this.settings.shapes.pageload_animation?h+="opacity: 0;":h+="opacity: "+t.opacity+";")),h},highlightShape:function(t,i){t=parseInt(t);var e=this.settings.spots[t];if(1!=isTrue(this.settings.layers.enable_layers)||e.layerID==this.settings.runtime.layerID){if(i&&""!==e.connected_to)return n=this.getIndexOfShapeWithID(e.connected_to),void this.highlightShape(n,!0);if(this.connectedShapes[e.id])for(var s=0;s<this.connectedShapes[e.id].length;s++){var n=this.connectedShapes[e.id][s].index;this.highlightShape(n,!1)}this.root.find("#"+e.id)[0].classList.add("imp-shape-highlighted"),"image"===e.mouseover_style.background_type&&this.imageBackgroundsContainer.find('[data-id="'+e.id+'"]').css({"background-image":'url("'+e.mouseover_style.background_image_url+'")',opacity:e.mouseover_style.background_image_opacity,transform:"scale("+e.mouseover_style.background_image_scale+") translate("+e.mouseover_style.background_image_offset_x+"px, "+e.mouseover_style.background_image_offset_y+"px)"}),$.imageMapProEventHighlightedShape(this.settings.general.name,e.title),-1===this.highlightedShapes.indexOf(t)&&this.highlightedShapes.push(t)}},unhighlightShape:function(t){t=parseInt(t);var i=this.settings.spots[t];isTrue(this.settings.layers.enable_layers)&&parseInt(i.layerID)!=parseInt(this.settings.runtime.layerID)||-1==this.apiHighlightedShapes.indexOf(t)&&(this.root.find("#"+i.id)[0].classList.remove("imp-shape-highlighted"),"image"===i.default_style.background_type&&this.imageBackgroundsContainer.find('[data-id="'+i.id+'"]').css({"background-image":"url("+i.default_style.background_image_url+")",opacity:i.default_style.background_image_opacity,transform:"scale("+i.default_style.background_image_scale+") translate("+i.default_style.background_image_offset_x+"px, "+i.default_style.background_image_offset_y+"px)"}),$.imageMapProEventUnhighlightedShape(this.settings.general.name,i.title),i=this.highlightedShapes.indexOf(t),this.highlightedShapes.splice(i,1))},unhighlightAllShapes:function(){for(var t=this.highlightedShapes.slice(0),i=0;i<t.length;i++)this.unhighlightShape(t[i])},isShapeHighlighted:function(t){for(var i=0;i<this.highlightedShapes.length;i++)if(this.highlightedShapes[i]===t)return!0;return!1},focusShape:function(t){if(isTrue(this.settings.zooming.enable_zooming)){for(var i=[],e=0;e<this.settings.spots.length;e++)this.settings.spots[e].connected_to===this.settings.spots[t].id&&i.push(this.settings.spots[e]);var s=this.settings.spots[t],n=0,a=0;if(0<i.length){var o=999,h=999,r=0,p=0;s.x<o&&(o=s.x),s.y<h&&(h=s.y),s.x>r&&(r=s.x),s.y>p&&(p=s.y);for(e=0;e<i.length;e++)i[e].x<o&&(o=i[e].x),i[e].y<h&&(h=i[e].y),i[e].x>r&&(r=i[e].x),i[e].y>p&&(p=i[e].y);n=r-o,a=p-h}else"spot"===s.type?((n/=this.wrapWidth)<25&&(n=25),(a/=this.wrapHeight)<25&&(a=25)):(n=s.width,a=s.height);var a=50/(n<a?a:a<=n?n:0),l=((a=a<1?1:a)>this.maxZoomLevel&&(a=this.maxZoomLevel),0),g=0,g="spot"===s.type?(l=s.x,s.y):(l=s.x+s.width/2,s.y+s.height/2);if(0<i.length){for(e=0;e<i.length;e++)"spot"===i[e].type?(l+=i[e].x,g+=i[e].y):(l+=i[e].x+i[e].width/2,g+=i[e].y+i[e].height/2);l/=i.length+1,g/=i.length+1}l=l/100*this.wrapWidth*a,g=g/100*this.wrapHeight*a,this.applyZoom(a),this.panTo(l,g)}},performClickAction:function(i){var s=this.settings.spots[i];"follow-link"===s.actions.click&&(0===$("#imp-temp-link").length&&$("body").append('<a href="" id="imp-temp-link" target="_blank"></a>'),$("#imp-temp-link").attr("href",s.actions.link),isTrue(s.actions.open_link_in_new_window)?$("#imp-temp-link").attr("target","_blank"):$("#imp-temp-link").removeAttr("target"),$("#imp-temp-link")[0].click()),"run-script"===s.actions.click&&eval(s.actions.script.replace("<br>","")),$.imageMapProEventClickedShape(this.settings.general.name,this.settings.spots[i].title)},showTooltip:function(t,i){var e,s,n=this.settings.spots[t];if("text"!==n.type&&-1==this.openedTooltips.indexOf(t)){if(isTrue(this.settings.tooltips.show_title_on_mouseover)&&"click"===this.settings.tooltips.show_tooltips&&((s=this.tooltipsContainer.find('.imp-tooltip[data-index="'+t+'"]')).find(".imp-tooltip-title").hide(),s.find(".imp-tooltip-plain-text").show(),s.find(".squares-container").show(),s.css({left:0,top:0})),""!=n.connected_to&&isTrue(n.use_connected_shape_tooltip))return n=this.getIndexOfShapeWithID(n.connected_to),void this.showTooltip(n);0<this.openedTooltips.length&&this.hideAllTooltips(),-1===this.openedTooltips.indexOf(t)&&this.openedTooltips.push(t),"mobile-only"===this.settings.tooltips.fullscreen_tooltips&&isMobile()||"always"===this.settings.tooltips.fullscreen_tooltips?(this.visibleFullscreenTooltip=$('.imp-fullscreen-tooltip[data-index="'+t+'"]'),this.visibleFullscreenTooltipIndex=t,this.fullscreenTooltipsContainer.show(),this.visibleFullscreenTooltip.show(),e=this,setTimeout(function(){e.visibleFullscreenTooltip.addClass("imp-tooltip-visible")},20),this.fullscreenTooltipVisible=!0,this.bodyOverflow=$("body").css("overflow"),$("body").css({overflow:"hidden"})):((s=this.tooltipsContainer.find('.imp-tooltip[data-index="'+t+'"]')).show(),setTimeout(function(){s.addClass("imp-tooltip-visible")},1),this.measureTooltipSize(t),this.updateTooltipPosition(t,i)),$.imageMapProEventOpenedTooltip(this.settings.general.name,this.settings.spots[t].title)}},hideTooltip:function(t){var i,e;"text"!==this.settings.spots[t].type&&-1==this.apiOpenedTooltips.indexOf(t)&&(i=this.openedTooltips.indexOf(t),this.openedTooltips.splice(i,1),"mobile-only"===this.settings.tooltips.fullscreen_tooltips&&isMobile()||"always"===this.settings.tooltips.fullscreen_tooltips?((e=this.fullscreenTooltipsContainer.find('.imp-fullscreen-tooltip[data-index="'+t+'"]')).removeClass("imp-tooltip-visible"),this.fullscreenTooltipsContainer.hide(),e.hide(),this.fullscreenTooltipVisible=!1,$("body").css({overflow:this.bodyOverflow})):(e=this.tooltipsContainer.find('.imp-tooltip[data-index="'+t+'"]'),setTimeout(function(){e.removeClass("imp-tooltip-visible"),e.hasClass("imp-tooltip-visible")||e.hide()},1),e.find("video").trigger("pause"),e.find("iframe").each(function(){$(this).attr("src",$(this).attr("src"))})),$.imageMapProEventClosedTooltip(this.settings.general.name,this.settings.spots[t].title))},hideAllTooltips:function(){for(var t=this.openedTooltips.slice(0),i=0;i<t.length;i++)this.hideTooltip(t[i])},hideAllTitles:function(){for(var t=0;t<this.settings.spots.length;t++)this.hideTooltipTitle(t,!0)},showTooltipTitle:function(t,i){var e;"text"!==this.settings.spots[t].type&&-1==this.openedTooltips.indexOf(t)&&((e=this.tooltipsContainer.find('.imp-tooltip[data-index="'+t+'"]')).hasClass("imp-tooltip-visible")||(e.find(".squares-container").hide(),e.find(".imp-tooltip-title").show(),e.find(".imp-tooltip-title .squares-container").show(),e.find(".imp-tooltip-plain-text").hide(),e.show(),setTimeout(function(){e.addClass("imp-tooltip-visible")},1),e.data("imp-measured-width",e.outerWidth()),e.data("imp-measured-height",e.outerHeight())),this.updateTooltipPosition(t,i))},hideTooltipTitle:function(t){"text"!==this.settings.spots[t].type&&-1==this.openedTooltips.indexOf(t)&&((t=this.tooltipsContainer.find('.imp-tooltip[data-index="'+t+'"]')).find(".imp-tooltip-title").hide(),t.find(".imp-tooltip-plain-text").show(),t.find(".squares-container").show(),t.css({width:"auto"}),t.removeClass("imp-tooltip-visible"),t.hide())},updateTooltipPosition:function(t,i){var e,s,n,a,o,h,r,p,l,g,d;this.fullscreenTooltipVisible||(s=(e=this.tooltipsContainer.find('.imp-tooltip[data-index="'+t+'"]')).data("imp-measured-width"),n=e.data("imp-measured-height"),t=this.settings.spots[t],a=window.innerWidth,o=window.innerHeight,isTrue(this.settings.tooltips.sticky_tooltips)&&i?(h=(i=this.getEventCoordinates(i)).x,i=i.y,h=h-this.wrapOffsetLeft,r=i-this.wrapOffsetTop,l=p=0):(p=t.width/100*this.wrapWidth,l=t.height/100*this.wrapHeight,p*=this.targetZoom,l*=this.targetZoom,h=Math.round(10*t.x)/10/100*this.wrapWidth,r=Math.round(10*t.y)/10/100*this.wrapHeight,h=h*this.targetZoom+this.targetPanX,r=r*this.targetZoom+this.targetPanY),"spot"===t.type&&(h-=t.width/2,isTrue(this.settings.tooltips.sticky_tooltips)||(r-=t.height/2),p=t.width,l=t.height),"spot"===t.type&&isTrue(t.default_style.icon_is_pin)&&"spot"===t.type&&isTrue(t.default_style.use_icon)&&!isTrue(this.settings.tooltips.sticky_tooltips)&&(r-=l/2),isTrue(this.settings.runtime.is_fullscreen)&&isTrue(this.settings.tooltips.constrain_tooltips)?(h+this.wrapOffsetLeft<0&&(p=p+h+this.wrapOffsetLeft,h=-this.wrapOffsetLeft),h+this.wrapOffsetLeft+p>a&&(p+=a-(h+this.wrapOffsetLeft+p)),r+this.wrapOffsetTop<0&&(l=l+r+this.wrapOffsetTop,r=-this.wrapOffsetTop),r+this.wrapOffsetTop+l>o&&(l+=o-(r+this.wrapOffsetTop+l))):(h<0&&(p+=h,h=0),h+p>this.wrapWidth&&(p=this.wrapWidth-h),r<0&&(l+=r,r=0),r+l>this.wrapHeight&&(l=this.wrapHeight-r)),"left"===t.tooltip_style.position&&(g=h-s-20,d=r+l/2-n/2),"right"===t.tooltip_style.position&&(g=h+p+20,d=r+l/2-n/2),"top"===t.tooltip_style.position&&(g=h+p/2-s/2,d=r-n-20),"bottom"===t.tooltip_style.position&&(g=h+p/2-s/2,d=r+l+20),i={x:g,y:d},isTrue(this.settings.tooltips.constrain_tooltips)&&((i=fitRectToScreen(g+this.wrapOffsetLeft,d+this.wrapOffsetTop,s,n)).x-=this.wrapOffsetLeft,i.y-=this.wrapOffsetTop),i.x+=t.tooltip_style.offset_x/100*this.wrapWidth,i.y+=t.tooltip_style.offset_y/100*this.wrapHeight,e.css({left:i.x+this.wrapOffsetLeft-this.tooltipsContainer.offset().left,top:i.y+this.wrapOffsetTop-this.tooltipsContainer.offset().top}))},updateOpenedTooltipsPosition:function(){for(var t=0;t<this.openedTooltips.length;t++)this.updateTooltipPosition(this.openedTooltips[t])},toggleFullscreen:function(){var t,i;isTrue(this.settings.runtime.is_fullscreen)?($("body").removeClass("imp-fullscreen-mode"),$("#imp-fullscreen-wrap").remove(),this.disableEvents(),delete instances[this.settings.general.name],fullscreenMapParent.events()):($("body").addClass("imp-fullscreen-mode"),(t=$.extend(!0,{},this.settings)).runtime.is_fullscreen=1,t.id="999999",t.general.responsive=0,t.general.width=this.settings.general.naturalWidth,t.general.height=this.settings.general.naturalHeight,t.general.name+="-fullscreen",isTrue(this.settings.shapes_menu.enable_shapes_menu)&&isTrue(this.settings.shapes_menu.detached_menu)&&(t.shapes_menu.detached_menu=0),i="",i+="background: "+this.settings.fullscreen.fullscreen_background,$("body").append('<div id="imp-fullscreen-wrap" style="'+i+'"><div id="image-map-pro-'+t.id+'"></div></div>'),$("#image-map-pro-"+t.id).imageMapPro(t),this.disableEvents(),fullscreenMapParent=this)},resetZoomAndPan:function(){this.zoom=1,this.targetZoom=1,this.targetPanX=0,this.targetPanY=0,this.actualPanX=0,this.actualPanY=0,this.redraw(!1)},zoomIn:function(t){var i,e,s,n,a;this.targetZoom<this.maxZoomLevel&&(i=this.zoom*this.zoomMultiplier,a=e=0,s=this.wrap.width(),n=this.wrap.height(),a=t?(e=t.pageX,t.pageY):(e=this.wrap.offset().left+s/2,this.wrap.offset().top+n/2),this.applyZoom(i,e,a))},zoomOut:function(t){var i,e,s,n,a;1<this.targetZoom&&(i=this.zoom/this.zoomMultiplier,a=e=0,s=this.wrap.width(),n=this.wrap.height(),a=t?(e=t.pageX,t.pageY):(e=this.wrap.offset().left+s/2,this.wrap.offset().top+n/2),this.applyZoom(i,e,a))},applyZoom:function(t,i,e){this.targetZoom=this.zoom,this.targetPanX=this.actualPanX,this.targetPanY=this.actualPanY,t>this.maxZoomLevel&&(t=this.maxZoomLevel),this.targetZoom=t=t<1?1:t;var t=(this.wrapWidth*this.targetZoom-this.wrapWidth*this.zoom)/2,s=(this.wrapHeight*this.targetZoom-this.wrapHeight*this.zoom)/2;i&&e&&(i=i-this.zoomWrap.offset().left,e=e-this.zoomWrap.offset().top,i=t*((this.wrapWidth*this.zoom/2-i)/(this.wrapWidth*this.zoom/2)),e=s*((this.wrapHeight*this.zoom/2-e)/(this.wrapHeight*this.zoom/2)),this.targetPanX-=t,this.targetPanY-=s,this.targetPanX+=i,this.targetPanY+=e),0<this.targetPanX&&(this.targetPanX=0),0<this.targetPanY&&(this.targetPanY=0),this.targetPanX<this.wrapWidth-this.wrapWidth*this.targetZoom&&(this.targetPanX=this.wrapWidth-this.wrapWidth*this.targetZoom),this.targetPanY<this.wrapHeight-this.wrapHeight*this.targetZoom&&(this.targetPanY=this.wrapHeight-this.wrapHeight*this.targetZoom);for(var n=0;n<this.settings.spots.length;n++){var a=this.settings.spots[n];"spot"===a.type&&this.wrap.find("#"+a.id).css({transform:"scale("+1/this.targetZoom+")"})}"mouseover"===this.settings.tooltips.show_tooltips?this.hideAllTooltips():this.updateOpenedTooltipsPosition(),this.redraw(!0)},pan:function(t,i){t=this.ix-t,i=this.iy-i;this.targetPanX=this.initialPanX-t,this.targetPanY=this.initialPanY-i,0<this.targetPanX&&(this.targetPanX=0),0<this.targetPanY&&(this.targetPanY=0),this.targetPanX<this.wrapWidth-this.wrapWidth*this.zoom&&(this.targetPanX=this.wrapWidth-this.wrapWidth*this.zoom),this.targetPanY<this.wrapHeight-this.wrapHeight*this.zoom&&(this.targetPanY=this.wrapHeight-this.wrapHeight*this.zoom),"mouseover"===this.settings.tooltips.show_tooltips?this.hideAllTooltips():(this.tooltipsContainer.addClass("imp-no-transition"),this.updateOpenedTooltipsPosition()),this.redraw(!1)},panTo:function(t,i){t=-t+this.wrapWidth/2,i=-i+this.wrapHeight/2;this.targetPanX=t,this.targetPanY=i,0<this.targetPanX&&(this.targetPanX=0),0<this.targetPanY&&(this.targetPanY=0),this.targetPanX<this.wrapWidth-this.wrapWidth*this.targetZoom&&(this.targetPanX=this.wrapWidth-this.wrapWidth*this.targetZoom),this.targetPanY<this.wrapHeight-this.wrapHeight*this.targetZoom&&(this.targetPanY=this.wrapHeight-this.wrapHeight*this.targetZoom),"mouseover"===this.settings.tooltips.show_tooltips?this.hideAllTooltips():this.updateOpenedTooltipsPosition(),this.redraw(!0)},pinch:function(t){var i=(t.originalEvent.touches[0].pageX+t.originalEvent.touches[1].pageX)/2,e=(t.originalEvent.touches[0].pageY+t.originalEvent.touches[1].pageY)/2,s=(this.actualPanX+=i-this.lastX,this.actualPanY+=e-this.lastY,this.wrap.width()),n=this.wrap.height(),a=this.wrap.offset().left,o=this.wrap.offset().top,h=window.innerWidth,r=window.innerHeight;isTrue(this.settings.runtime.is_fullscreen)?(s*this.zoom>h?(this.actualPanX>-a&&(this.actualPanX=-a),this.actualPanX<h-s*this.targetZoom-a&&(this.actualPanX=h-s*this.targetZoom-a)):this.actualPanX=(s-s*this.targetZoom)/2,n*this.zoom>r?(this.actualPanY>-o&&(this.actualPanY=-o),this.actualPanY<r-n*this.targetZoom-o&&(this.actualPanY=r-n*this.targetZoom-o)):this.actualPanY=(n-n*this.targetZoom)/2):(0<this.actualPanX&&(this.actualPanX=0),0<this.actualPanY&&(this.actualPanY=0),this.actualPanX<s-s*this.targetZoom&&(this.actualPanX=s-s*this.targetZoom),this.actualPanY<n-n*this.targetZoom&&(this.actualPanY=n-n*this.targetZoom)),this.lastX=i,this.lastY=e;h=Math.sqrt(Math.pow(t.originalEvent.touches[1].pageX-t.originalEvent.touches[0].pageX,2)+Math.pow(t.originalEvent.touches[1].pageY-t.originalEvent.touches[0].pageY,2))/this.pinchInitialDistance;this.applyZoom(this.pinchInitialZoom*h,i,e)},redraw:function(t){var i,e,s,n,a;t?(this.zoom=lerp(this.zoom,this.targetZoom,.1),this.actualPanX=lerp(this.actualPanX,this.targetPanX,.1),this.actualPanY=lerp(this.actualPanY,this.targetPanY,.1),Math.abs(this.zoom-this.targetZoom)<.001&&(this.zoom=this.targetZoom),Math.abs(this.actualPanX-this.targetPanX)<1&&(this.actualPanX=this.targetPanX),Math.abs(this.actualPanY-this.targetPanY)<1&&(this.actualPanY=this.targetPanY)):(this.zoom=this.targetZoom,this.actualPanX=this.targetPanX,this.actualPanY=this.targetPanY),this.zoomWrap.css({transform:"scale("+this.zoom+", "+this.zoom+")"}),this.translateWrap.css({transform:"translate("+this.actualPanX+"px, "+this.actualPanY+"px)"}),isTrue(this.settings.zooming.enable_navigator)&&isTrue(this.settings.zooming.enable_zooming)&&(i=-this.actualPanX*this.navigatorRatio/this.zoom+this.navigatorMarginX/this.zoom,e=this.wrapWidth*this.navigatorRatio-(i+ +this.uiNavigatorWindowWidth/this.zoom),s=-this.actualPanY*this.navigatorRatio/this.zoom+this.navigatorMarginY/this.zoom,n=this.wrapHeight*this.navigatorRatio-(s+ +this.uiNavigatorWindowHeight/this.zoom),this.uiNavigatorImage.css({"clip-path":"inset("+s+"px "+e+"px "+n+"px "+i+"px)","-webkit-clip-path":"inset("+s+"px "+e+"px "+n+"px "+i+"px)","-moz-clip-path":"inset("+s+"px "+e+"px "+n+"px "+i+"px)"})),!t||(a=this).zoom==this.targetZoom&&this.actualPanX==this.targetPanX&&this.actualPanY==this.targetPanY||window.requestAnimationFrame(function(){a.redraw(t)})},switchLayer:function(t,i){this.settings.runtime.layerID=t,this.openedTooltips=[],this.apiOpenedTooltips=[],this.highlightedShapes=[],this.apiHighlightedShapes=[],this.shapesMenuWrap&&(this.settings.runtime.menu_scroll=this.shapesMenuWrap.find(".imp-shapes-menu-scroll-wrap").scrollTop());for(var e="",s=0;s<this.settings.layers.layers_list.length;s++)if(parseInt(this.settings.layers.layers_list[s].id,10)===parseInt(this.settings.runtime.layerID,10)){e=this.settings.layers.layers_list[s].title,this.settings.general.naturalWidth=this.settings.layers.layers_list[s].image_width,this.settings.general.naturalHeight=this.settings.layers.layers_list[s].image_height,isTrue(this.settings.runtime.is_fullscreen)&&(this.settings.general.width=this.settings.layers.layers_list[s].image_width,this.settings.general.height=this.settings.layers.layers_list[s].image_height);break}var n=this;this.init(function(){i&&i(),$.imageMapProEventSwitchedFloor(n.settings.general.name,e)})},updateMenuSearch:function(){var e=$('[data-image-map-pro-search-id="'+this.settings.id+'"]').val();e&&0<e.length?(this.shapesMenuWrap.addClass("imp-searching"),$(".imp-shapes-menu-shape-title").each(function(){var t=new RegExp("("+e+")","gi"),i=$(this).data("imp-content"),t=$(this).data("imp-content").replace(t,'<span class="imp-search-highlight">$&</span>');i!=t?($(this).show(),$(this).html(t)):($(this).hide(),$(this).html(i))})):(this.shapesMenuWrap.removeClass("imp-searching"),$(".imp-shapes-menu-shape-title, .imp-shapes-menu-layer-title").each(function(){$(this).show(),$(this).html($(this).data("imp-content"))})),this.settings.runtime.menu_search_string=e},displayScrollMessage:function(){this.scrollMessage.fadeIn(),clearTimeout(this.hideScrollMessageTimeout);var t=this;this.hideScrollMessageTimeout=setTimeout(function(){t.scrollMessage.fadeOut()},1e3)},showResponsiveShapesMenu:function(){this.responsiveShapesMenuWrap&&(this.responsiveShapesMenuWrap.addClass("imp-responsive-menu-visible"),$("body").addClass("imp-noscroll"))},hideResponsiveShapesMenu:function(){this.responsiveShapesMenuWrap&&(this.responsiveShapesMenuWrap.removeClass("imp-responsive-menu-visible"),$("body").removeClass("imp-noscroll"))}}),$.fn[pluginName]=function(t){return this.each(function(){$.data(this,"plugin_"+pluginName,new Plugin(this,t))})}}(jQuery,window,document),!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(l){function i(t){var i,e=t||window.event,s=m.call(arguments,1),n=0,a=0,o=0,h=0,r=0,p=0;if((t=l.event.fix(e)).type="mousewheel","detail"in e&&(o=-1*e.detail),"wheelDelta"in e&&(o=e.wheelDelta),"wheelDeltaY"in e&&(o=e.wheelDeltaY),"wheelDeltaX"in e&&(a=-1*e.wheelDeltaX),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(a=-1*o,o=0),n=0===o?a:o,"deltaY"in e&&(n=o=-1*e.deltaY),"deltaX"in e&&(a=e.deltaX,0===o&&(n=-1*a)),0!==o||0!==a)return 1===e.deltaMode?(n*=i=l.data(this,"mousewheel-line-height"),o*=i,a*=i):2===e.deltaMode&&(n*=i=l.data(this,"mousewheel-page-height"),o*=i,a*=i),h=Math.max(Math.abs(o),Math.abs(a)),(!c||h<c)&&d(e,c=h)&&(c/=40),d(e,h)&&(n/=40,a/=40,o/=40),n=Math[1<=n?"floor":"ceil"](n/c),a=Math[1<=a?"floor":"ceil"](a/c),o=Math[1<=o?"floor":"ceil"](o/c),f.settings.normalizeOffset&&this.getBoundingClientRect&&(i=this.getBoundingClientRect(),r=t.clientX-i.left,p=t.clientY-i.top),t.deltaX=a,t.deltaY=o,t.deltaFactor=c,t.offsetX=r,t.offsetY=p,t.deltaMode=0,s.unshift(t,n,a,o),u&&clearTimeout(u),u=setTimeout(g,200),(l.event.dispatch||l.event.handle).apply(this,s)}function g(){c=null}function d(t,i){return f.settings.adjustOldDeltas&&"mousewheel"===t.type&&i%120==0}var u,c,t=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],e="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],m=Array.prototype.slice;if(l.event.fixHooks)for(var s=t.length;s;)l.event.fixHooks[t[--s]]=l.event.mouseHooks;var f=l.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var t=e.length;t;)this.addEventListener(e[--t],i,!1);else this.onmousewheel=i;l.data(this,"mousewheel-line-height",f.getLineHeight(this)),l.data(this,"mousewheel-page-height",f.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=e.length;t;)this.removeEventListener(e[--t],i,!1);else this.onmousewheel=null;l.removeData(this,"mousewheel-line-height"),l.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var t=l(t),i=t["offsetParent"in l.fn?"offsetParent":"parent"]();return i.length||(i=l("body")),parseInt(i.css("fontSize"),10)||parseInt(t.css("fontSize"),10)||16},getPageHeight:function(t){return l(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};l.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})});